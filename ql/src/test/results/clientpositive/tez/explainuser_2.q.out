PREHOOK: query: -- SORT_QUERY_RESULTS

CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@dest_j1
POSTHOOK: query: -- SORT_QUERY_RESULTS

CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@dest_j1
PREHOOK: query: CREATE TABLE ss(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@ss
POSTHOOK: query: CREATE TABLE ss(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@ss
PREHOOK: query: CREATE TABLE sr(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@sr
POSTHOOK: query: CREATE TABLE sr(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@sr
PREHOOK: query: CREATE TABLE cs(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@cs
POSTHOOK: query: CREATE TABLE cs(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@cs
PREHOOK: query: INSERT OVERWRITE TABLE ss
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Input: default@src1
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Output: default@ss
POSTHOOK: query: INSERT OVERWRITE TABLE ss
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Input: default@src1
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Output: default@ss
POSTHOOK: Lineage: ss.k1 SIMPLE [(src1)x.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: ss.k2 SIMPLE [(src)y.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: ss.k3 EXPRESSION [(srcpart)z.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: ss.v1 SIMPLE [(src1)x.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: ss.v2 SIMPLE [(src)y.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: ss.v3 EXPRESSION [(srcpart)z.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: INSERT OVERWRITE TABLE sr
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=12)
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Input: default@src1
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Output: default@sr
POSTHOOK: query: INSERT OVERWRITE TABLE sr
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=12)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Input: default@src1
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Output: default@sr
POSTHOOK: Lineage: sr.k1 SIMPLE [(src1)x.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: sr.k2 SIMPLE [(src)y.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: sr.k3 EXPRESSION [(srcpart)z.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: sr.v1 SIMPLE [(src1)x.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: sr.v2 SIMPLE [(src)y.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: sr.v3 EXPRESSION [(srcpart)z.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: INSERT OVERWRITE TABLE cs
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08')
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Input: default@src1
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Output: default@cs
POSTHOOK: query: INSERT OVERWRITE TABLE cs
SELECT x.key,x.value,y.key,y.value,z.key,z.value
FROM src1 x 
JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08')
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Input: default@src1
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Output: default@cs
POSTHOOK: Lineage: cs.k1 SIMPLE [(src1)x.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: cs.k2 EXPRESSION [(src)y.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: cs.k3 SIMPLE [(srcpart)z.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: cs.v1 SIMPLE [(src1)x.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: cs.v2 EXPRESSION [(src)y.FieldSchema(name:value, type:string, comment:default), ]
POSTHOOK: Lineage: cs.v3 SIMPLE [(srcpart)z.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@ss
PREHOOK: Output: default@ss
POSTHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@ss
POSTHOOK: Output: default@ss
PREHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
PREHOOK: type: QUERY
PREHOOK: Input: default@ss
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE ss COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@ss
#### A masked pattern was here ####
PREHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@sr
PREHOOK: Output: default@sr
POSTHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sr
POSTHOOK: Output: default@sr
PREHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
PREHOOK: type: QUERY
PREHOOK: Input: default@sr
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE sr COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@sr
#### A masked pattern was here ####
PREHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS
PREHOOK: type: QUERY
PREHOOK: Input: default@cs
PREHOOK: Output: default@cs
POSTHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cs
POSTHOOK: Output: default@cs
PREHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
PREHOOK: type: QUERY
PREHOOK: Input: default@cs
#### A masked pattern was here ####
POSTHOOK: query: ANALYZE TABLE cs COMPUTE STATISTICS FOR COLUMNS k1,v1,k2,v2,k3,v3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cs
#### A masked pattern was here ####
PREHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Map 3 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_19]
            compressed:false
            Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_18]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_29]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"_col3 (type: string)","0":"_col0 (type: string)"}
               |  outputColumnNames:["_col1","_col2","_col5"]
               |  Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_14]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:_col1 (type: string)
               |     Select Operator [SEL_1]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |        Filter Operator [FIL_25]
               |           predicate:key is not null (type: boolean)
               |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           TableScan [TS_0]
               |              alias:y
               |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Reducer 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_16]
                     key expressions:_col3 (type: string)
                     Map-reduce partition columns:_col3 (type: string)
                     sort order:+
                     Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                     value expressions:_col0 (type: string)
                     Merge Join Operator [MERGEJOIN_28]
                     |  condition map:[{"":"Inner Join 0 to 1"}]
                     |  keys:{"1":"_col1 (type: string)","0":"_col0 (type: string)"}
                     |  outputColumnNames:["_col0","_col3"]
                     |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                     |<-Map 3 [SIMPLE_EDGE]
                     |  Reduce Output Operator [RS_8]
                     |     key expressions:_col0 (type: string)
                     |     Map-reduce partition columns:_col0 (type: string)
                     |     sort order:+
                     |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |     Select Operator [SEL_4]
                     |        outputColumnNames:["_col0"]
                     |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |        Filter Operator [FIL_26]
                     |           predicate:value is not null (type: boolean)
                     |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |           TableScan [TS_2]
                     |              alias:z
                     |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |<-Map 5 [SIMPLE_EDGE]
                        Reduce Output Operator [RS_10]
                           key expressions:_col1 (type: string)
                           Map-reduce partition columns:_col1 (type: string)
                           sort order:+
                           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           value expressions:_col0 (type: string)
                           Select Operator [SEL_6]
                              outputColumnNames:["_col0","_col1"]
                              Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                              Filter Operator [FIL_27]
                                 predicate:(value is not null and key is not null) (type: boolean)
                                 Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                 TableScan [TS_5]
                                    alias:x
                                    Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 6 (SIMPLE_EDGE)
Reducer 13 <- Map 12 (SIMPLE_EDGE), Map 14 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
Reducer 11 <- Map 10 (SIMPLE_EDGE), Reducer 13 (SIMPLE_EDGE)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
Reducer 9 <- Reducer 16 (SIMPLE_EDGE), Reducer 8 (SIMPLE_EDGE)
Reducer 8 <- Map 7 (SIMPLE_EDGE), Reducer 11 (SIMPLE_EDGE)
Reducer 16 <- Map 15 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:100
      Stage-1
         Reducer 5
         File Output Operator [FS_71]
            compressed:false
            Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Limit [LIM_70]
               Number of rows:100
               Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
               Select Operator [SEL_69]
               |  outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               |  Statistics:Num rows: 402 Data size: 4276 Basic stats: COMPLETE Column stats: NONE
               |<-Reducer 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_68]
                     key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                     sort order:+++
                     Statistics:Num rows: 402 Data size: 4276 Basic stats: COMPLETE Column stats: NONE
                     value expressions:_col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
                     Group By Operator [GBY_66]
                     |  aggregations:["count(VALUE._col0)","count(VALUE._col1)","count(VALUE._col2)"]
                     |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
                     |  outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                     |  Statistics:Num rows: 402 Data size: 4276 Basic stats: COMPLETE Column stats: NONE
                     |<-Reducer 3 [SIMPLE_EDGE]
                        Reduce Output Operator [RS_65]
                           key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                           Map-reduce partition columns:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                           sort order:+++
                           Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                           value expressions:_col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
                           Group By Operator [GBY_64]
                              aggregations:["count(_col3)","count(_col4)","count(_col5)"]
                              keys:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                              outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                              Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                              Select Operator [SEL_62]
                                 outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                                 Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                                 Merge Join Operator [MERGEJOIN_113]
                                 |  condition map:[{"":"Inner Join 0 to 1"}]
                                 |  keys:{"1":"_col15 (type: string), _col17 (type: string)","0":"_col1 (type: string), _col3 (type: string)"}
                                 |  outputColumnNames:["_col2","_col3","_col12","_col13","_col20","_col21"]
                                 |  Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                                 |<-Reducer 2 [SIMPLE_EDGE]
                                 |  Reduce Output Operator [RS_58]
                                 |     key expressions:_col1 (type: string), _col3 (type: string)
                                 |     Map-reduce partition columns:_col1 (type: string), _col3 (type: string)
                                 |     sort order:++
                                 |     Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                 |     value expressions:_col2 (type: string)
                                 |     Merge Join Operator [MERGEJOIN_107]
                                 |     |  condition map:[{"":"Inner Join 0 to 1"}]
                                 |     |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                 |     |  outputColumnNames:["_col1","_col2","_col3"]
                                 |     |  Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                 |     |<-Map 1 [SIMPLE_EDGE]
                                 |     |  Reduce Output Operator [RS_53]
                                 |     |     key expressions:_col0 (type: string)
                                 |     |     Map-reduce partition columns:_col0 (type: string)
                                 |     |     sort order:+
                                 |     |     Statistics:Num rows: 22 Data size: 762 Basic stats: COMPLETE Column stats: NONE
                                 |     |     value expressions:_col1 (type: string), _col2 (type: string), _col3 (type: string)
                                 |     |     Select Operator [SEL_1]
                                 |     |        outputColumnNames:["_col0","_col1","_col2","_col3"]
                                 |     |        Statistics:Num rows: 22 Data size: 762 Basic stats: COMPLETE Column stats: NONE
                                 |     |        Filter Operator [FIL_99]
                                 |     |           predicate:((k1 is not null and v2 is not null) and v3 is not null) (type: boolean)
                                 |     |           Statistics:Num rows: 22 Data size: 762 Basic stats: COMPLETE Column stats: NONE
                                 |     |           TableScan [TS_0]
                                 |     |              alias:cs
                                 |     |              Statistics:Num rows: 170 Data size: 5890 Basic stats: COMPLETE Column stats: NONE
                                 |     |<-Map 6 [SIMPLE_EDGE]
                                 |        Reduce Output Operator [RS_55]
                                 |           key expressions:_col0 (type: string)
                                 |           Map-reduce partition columns:_col0 (type: string)
                                 |           sort order:+
                                 |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                 |           Select Operator [SEL_4]
                                 |              outputColumnNames:["_col0"]
                                 |              Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                 |              Filter Operator [FIL_100]
                                 |                 predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null) (type: boolean)
                                 |                 Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                 |                 TableScan [TS_2]
                                 |                    alias:d1
                                 |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                 |<-Reducer 9 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_60]
                                       key expressions:_col15 (type: string), _col17 (type: string)
                                       Map-reduce partition columns:_col15 (type: string), _col17 (type: string)
                                       sort order:++
                                       Statistics:Num rows: 731 Data size: 7775 Basic stats: COMPLETE Column stats: NONE
                                       value expressions:_col6 (type: string), _col7 (type: string), _col14 (type: string)
                                       Select Operator [SEL_51]
                                          outputColumnNames:["_col14","_col15","_col17","_col6","_col7"]
                                          Statistics:Num rows: 731 Data size: 7775 Basic stats: COMPLETE Column stats: NONE
                                          Merge Join Operator [MERGEJOIN_112]
                                          |  condition map:[{"":"Inner Join 0 to 1"}]
                                          |  keys:{"1":"_col2 (type: string), _col4 (type: string)","0":"_col8 (type: string), _col10 (type: string)"}
                                          |  outputColumnNames:["_col6","_col7","_col14","_col15","_col17"]
                                          |  Statistics:Num rows: 731 Data size: 7775 Basic stats: COMPLETE Column stats: NONE
                                          |<-Reducer 16 [SIMPLE_EDGE]
                                          |  Reduce Output Operator [RS_49]
                                          |     key expressions:_col2 (type: string), _col4 (type: string)
                                          |     Map-reduce partition columns:_col2 (type: string), _col4 (type: string)
                                          |     sort order:++
                                          |     Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                          |     value expressions:_col3 (type: string), _col5 (type: string)
                                          |     Merge Join Operator [MERGEJOIN_111]
                                          |     |  condition map:[{"":"Inner Join 0 to 1"}]
                                          |     |  keys:{"1":"_col0 (type: string)","0":"_col0 (type: string)"}
                                          |     |  outputColumnNames:["_col2","_col3","_col4","_col5"]
                                          |     |  Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                          |     |<-Map 15 [SIMPLE_EDGE]
                                          |     |  Reduce Output Operator [RS_36]
                                          |     |     key expressions:_col0 (type: string)
                                          |     |     Map-reduce partition columns:_col0 (type: string)
                                          |     |     sort order:+
                                          |     |     Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                          |     |     value expressions:_col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                                          |     |     Select Operator [SEL_31]
                                          |     |        outputColumnNames:["_col0","_col2","_col3","_col4","_col5"]
                                          |     |        Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                          |     |        Filter Operator [FIL_105]
                                          |     |           predicate:((((((v1 = 'srv1') and k1 is not null) and k2 is not null) and k3 is not null) and v2 is not null) and v3 is not null) (type: boolean)
                                          |     |           Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                          |     |           TableScan [TS_29]
                                          |     |              alias:sr
                                          |     |              Statistics:Num rows: 85 Data size: 2945 Basic stats: COMPLETE Column stats: NONE
                                          |     |<-Map 17 [SIMPLE_EDGE]
                                          |        Reduce Output Operator [RS_38]
                                          |           key expressions:_col0 (type: string)
                                          |           Map-reduce partition columns:_col0 (type: string)
                                          |           sort order:+
                                          |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                          |           Select Operator [SEL_34]
                                          |              outputColumnNames:["_col0"]
                                          |              Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                          |              Filter Operator [FIL_106]
                                          |                 predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null) (type: boolean)
                                          |                 Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                          |                 TableScan [TS_32]
                                          |                    alias:d1
                                          |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                          |<-Reducer 8 [SIMPLE_EDGE]
                                             Reduce Output Operator [RS_47]
                                                key expressions:_col8 (type: string), _col10 (type: string)
                                                Map-reduce partition columns:_col8 (type: string), _col10 (type: string)
                                                sort order:++
                                                Statistics:Num rows: 665 Data size: 7069 Basic stats: COMPLETE Column stats: NONE
                                                value expressions:_col6 (type: string), _col7 (type: string)
                                                Merge Join Operator [MERGEJOIN_110]
                                                |  condition map:[{"":"Inner Join 0 to 1"}]
                                                |  keys:{"1":"_col5 (type: string)","0":"_col1 (type: string)"}
                                                |  outputColumnNames:["_col6","_col7","_col8","_col10"]
                                                |  Statistics:Num rows: 665 Data size: 7069 Basic stats: COMPLETE Column stats: NONE
                                                |<-Map 7 [SIMPLE_EDGE]
                                                |  Reduce Output Operator [RS_42]
                                                |     key expressions:_col1 (type: string)
                                                |     Map-reduce partition columns:_col1 (type: string)
                                                |     sort order:+
                                                |     Statistics:Num rows: 6 Data size: 45 Basic stats: COMPLETE Column stats: NONE
                                                |     Select Operator [SEL_7]
                                                |        outputColumnNames:["_col1"]
                                                |        Statistics:Num rows: 6 Data size: 45 Basic stats: COMPLETE Column stats: NONE
                                                |        Filter Operator [FIL_101]
                                                |           predicate:((key = 'src1key') and value is not null) (type: boolean)
                                                |           Statistics:Num rows: 6 Data size: 45 Basic stats: COMPLETE Column stats: NONE
                                                |           TableScan [TS_5]
                                                |              alias:src1
                                                |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                                |<-Reducer 11 [SIMPLE_EDGE]
                                                   Reduce Output Operator [RS_44]
                                                      key expressions:_col5 (type: string)
                                                      Map-reduce partition columns:_col5 (type: string)
                                                      sort order:+
                                                      Statistics:Num rows: 605 Data size: 6427 Basic stats: COMPLETE Column stats: NONE
                                                      value expressions:_col4 (type: string), _col6 (type: string), _col8 (type: string)
                                                      Merge Join Operator [MERGEJOIN_109]
                                                      |  condition map:[{"":"Inner Join 0 to 1"}]
                                                      |  keys:{"1":"_col2 (type: string)","0":"_col0 (type: string)"}
                                                      |  outputColumnNames:["_col4","_col5","_col6","_col8"]
                                                      |  Statistics:Num rows: 605 Data size: 6427 Basic stats: COMPLETE Column stats: NONE
                                                      |<-Map 10 [SIMPLE_EDGE]
                                                      |  Reduce Output Operator [RS_24]
                                                      |     key expressions:_col0 (type: string)
                                                      |     Map-reduce partition columns:_col0 (type: string)
                                                      |     sort order:+
                                                      |     Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                                      |     Select Operator [SEL_10]
                                                      |        outputColumnNames:["_col0"]
                                                      |        Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                                      |        Filter Operator [FIL_102]
                                                      |           predicate:((value = 'd1value') and key is not null) (type: boolean)
                                                      |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                                      |           TableScan [TS_8]
                                                      |              alias:d1
                                                      |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                      |<-Reducer 13 [SIMPLE_EDGE]
                                                         Reduce Output Operator [RS_26]
                                                            key expressions:_col2 (type: string)
                                                            Map-reduce partition columns:_col2 (type: string)
                                                            sort order:+
                                                            Statistics:Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
                                                            value expressions:_col3 (type: string), _col4 (type: string), _col6 (type: string)
                                                            Merge Join Operator [MERGEJOIN_108]
                                                            |  condition map:[{"":"Inner Join 0 to 1"}]
                                                            |  keys:{"1":"_col3 (type: string)","0":"_col1 (type: string)"}
                                                            |  outputColumnNames:["_col2","_col3","_col4","_col6"]
                                                            |  Statistics:Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
                                                            |<-Map 12 [SIMPLE_EDGE]
                                                            |  Reduce Output Operator [RS_18]
                                                            |     key expressions:_col1 (type: string)
                                                            |     Map-reduce partition columns:_col1 (type: string)
                                                            |     sort order:+
                                                            |     Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                            |     Select Operator [SEL_13]
                                                            |        outputColumnNames:["_col1"]
                                                            |        Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                            |        Filter Operator [FIL_103]
                                                            |           predicate:((key = 'srcpartkey') and value is not null) (type: boolean)
                                                            |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                            |           TableScan [TS_11]
                                                            |              alias:srcpart
                                                            |              Statistics:Num rows: 2000 Data size: 21248 Basic stats: COMPLETE Column stats: NONE
                                                            |<-Map 14 [SIMPLE_EDGE]
                                                               Reduce Output Operator [RS_20]
                                                                  key expressions:_col3 (type: string)
                                                                  Map-reduce partition columns:_col3 (type: string)
                                                                  sort order:+
                                                                  Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                                                  value expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: string)
                                                                  Select Operator [SEL_16]
                                                                     outputColumnNames:["_col0","_col1","_col2","_col3","_col4"]
                                                                     Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                                                     Filter Operator [FIL_104]
                                                                        predicate:((((((v3 = 'ssv3') and v2 is not null) and k1 is not null) and v1 is not null) and k2 is not null) and k3 is not null) (type: boolean)
                                                                        Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                                                        TableScan [TS_14]
                                                                           alias:ss
                                                                           Statistics:Num rows: 85 Data size: 2945 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 8 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 12 <- Map 11 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE), Union 3 (CONTAINS)
Map 13 <- Union 14 (CONTAINS)
Map 5 <- Union 6 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Reducer 7 <- Union 6 (SIMPLE_EDGE)
Map 9 <- Union 6 (CONTAINS)
Reducer 8 <- Map 10 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
Reducer 15 <- Union 14 (SIMPLE_EDGE)
Reducer 16 <- Map 18 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
Map 17 <- Union 14 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_61]
            compressed:false
            Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_59]
            |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            |<-Union 3 [SIMPLE_EDGE]
               |<-Reducer 2 [CONTAINS]
               |  Reduce Output Operator [RS_58]
               |     key expressions:_col0 (type: string), _col1 (type: string)
               |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |     sort order:++
               |     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |     Group By Operator [GBY_57]
               |        keys:_col0 (type: string), _col1 (type: string)
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |        Select Operator [SEL_26]
               |           outputColumnNames:["_col0","_col1"]
               |           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           Merge Join Operator [MERGEJOIN_85]
               |           |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |  keys:{"1":"_col2 (type: string)","0":"_col0 (type: string)"}
               |           |  outputColumnNames:["_col2","_col3"]
               |           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           |<-Map 1 [SIMPLE_EDGE]
               |           |  Reduce Output Operator [RS_22]
               |           |     key expressions:_col0 (type: string)
               |           |     Map-reduce partition columns:_col0 (type: string)
               |           |     sort order:+
               |           |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |     Select Operator [SEL_1]
               |           |        outputColumnNames:["_col0"]
               |           |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |        Filter Operator [FIL_76]
               |           |           predicate:key is not null (type: boolean)
               |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |           TableScan [TS_0]
               |           |              alias:y
               |           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |<-Reducer 8 [SIMPLE_EDGE]
               |              Reduce Output Operator [RS_24]
               |                 key expressions:_col2 (type: string)
               |                 Map-reduce partition columns:_col2 (type: string)
               |                 sort order:+
               |                 Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
               |                 value expressions:_col1 (type: string)
               |                 Merge Join Operator [MERGEJOIN_84]
               |                 |  condition map:[{"":"Inner Join 0 to 1"}]
               |                 |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
               |                 |  outputColumnNames:["_col1","_col2"]
               |                 |  Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
               |                 |<-Map 10 [SIMPLE_EDGE]
               |                 |  Reduce Output Operator [RS_18]
               |                 |     key expressions:_col1 (type: string)
               |                 |     Map-reduce partition columns:_col1 (type: string)
               |                 |     sort order:+
               |                 |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                 |     value expressions:_col0 (type: string)
               |                 |     Select Operator [SEL_14]
               |                 |        outputColumnNames:["_col0","_col1"]
               |                 |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                 |        Filter Operator [FIL_79]
               |                 |           predicate:(value is not null and key is not null) (type: boolean)
               |                 |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                 |           TableScan [TS_13]
               |                 |              alias:x
               |                 |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |                 |<-Reducer 7 [SIMPLE_EDGE]
               |                    Reduce Output Operator [RS_16]
               |                       key expressions:_col1 (type: string)
               |                       Map-reduce partition columns:_col1 (type: string)
               |                       sort order:+
               |                       Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |                       Select Operator [SEL_12]
               |                          outputColumnNames:["_col1"]
               |                          Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |                          Group By Operator [GBY_11]
               |                          |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |                          |  outputColumnNames:["_col0","_col1"]
               |                          |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |                          |<-Union 6 [SIMPLE_EDGE]
               |                             |<-Map 5 [CONTAINS]
               |                             |  Reduce Output Operator [RS_10]
               |                             |     key expressions:_col0 (type: string), _col1 (type: string)
               |                             |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                             |     sort order:++
               |                             |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                             |     Group By Operator [GBY_9]
               |                             |        keys:_col0 (type: string), _col1 (type: string)
               |                             |        outputColumnNames:["_col0","_col1"]
               |                             |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                             |        Select Operator [SEL_3]
               |                             |           outputColumnNames:["_col0","_col1"]
               |                             |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |                             |           Filter Operator [FIL_77]
               |                             |              predicate:value is not null (type: boolean)
               |                             |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |                             |              TableScan [TS_2]
               |                             |                 alias:x
               |                             |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |                             |<-Map 9 [CONTAINS]
               |                                Reduce Output Operator [RS_10]
               |                                   key expressions:_col0 (type: string), _col1 (type: string)
               |                                   Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                                   sort order:++
               |                                   Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                                   Group By Operator [GBY_9]
               |                                      keys:_col0 (type: string), _col1 (type: string)
               |                                      outputColumnNames:["_col0","_col1"]
               |                                      Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                                      Select Operator [SEL_5]
               |                                         outputColumnNames:["_col0","_col1"]
               |                                         Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                                         Filter Operator [FIL_78]
               |                                            predicate:value is not null (type: boolean)
               |                                            Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                                            TableScan [TS_4]
               |                                               alias:y
               |                                               Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Reducer 12 [CONTAINS]
                  Reduce Output Operator [RS_58]
                     key expressions:_col0 (type: string), _col1 (type: string)
                     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                     sort order:++
                     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator [GBY_57]
                        keys:_col0 (type: string), _col1 (type: string)
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                        Select Operator [SEL_53]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           Merge Join Operator [MERGEJOIN_87]
                           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |  keys:{"1":"_col2 (type: string)","0":"_col0 (type: string)"}
                           |  outputColumnNames:["_col2","_col3"]
                           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |<-Map 11 [SIMPLE_EDGE]
                           |  Reduce Output Operator [RS_49]
                           |     key expressions:_col0 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |     Select Operator [SEL_28]
                           |        outputColumnNames:["_col0"]
                           |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |        Filter Operator [FIL_80]
                           |           predicate:key is not null (type: boolean)
                           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           TableScan [TS_27]
                           |              alias:y
                           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |<-Reducer 16 [SIMPLE_EDGE]
                              Reduce Output Operator [RS_51]
                                 key expressions:_col2 (type: string)
                                 Map-reduce partition columns:_col2 (type: string)
                                 sort order:+
                                 Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                                 value expressions:_col1 (type: string)
                                 Merge Join Operator [MERGEJOIN_86]
                                 |  condition map:[{"":"Inner Join 0 to 1"}]
                                 |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                                 |  outputColumnNames:["_col1","_col2"]
                                 |  Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                                 |<-Map 18 [SIMPLE_EDGE]
                                 |  Reduce Output Operator [RS_45]
                                 |     key expressions:_col1 (type: string)
                                 |     Map-reduce partition columns:_col1 (type: string)
                                 |     sort order:+
                                 |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                 |     value expressions:_col0 (type: string)
                                 |     Select Operator [SEL_41]
                                 |        outputColumnNames:["_col0","_col1"]
                                 |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                 |        Filter Operator [FIL_83]
                                 |           predicate:(value is not null and key is not null) (type: boolean)
                                 |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                 |           TableScan [TS_40]
                                 |              alias:x
                                 |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                 |<-Reducer 15 [SIMPLE_EDGE]
                                    Reduce Output Operator [RS_43]
                                       key expressions:_col1 (type: string)
                                       Map-reduce partition columns:_col1 (type: string)
                                       sort order:+
                                       Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                       Select Operator [SEL_39]
                                          outputColumnNames:["_col1"]
                                          Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                          Group By Operator [GBY_38]
                                          |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                          |  outputColumnNames:["_col0","_col1"]
                                          |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                          |<-Union 14 [SIMPLE_EDGE]
                                             |<-Map 13 [CONTAINS]
                                             |  Reduce Output Operator [RS_37]
                                             |     key expressions:_col0 (type: string), _col1 (type: string)
                                             |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                             |     sort order:++
                                             |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                             |     Group By Operator [GBY_36]
                                             |        keys:_col0 (type: string), _col1 (type: string)
                                             |        outputColumnNames:["_col0","_col1"]
                                             |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                             |        Select Operator [SEL_30]
                                             |           outputColumnNames:["_col0","_col1"]
                                             |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                             |           Filter Operator [FIL_81]
                                             |              predicate:value is not null (type: boolean)
                                             |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                             |              TableScan [TS_29]
                                             |                 alias:x
                                             |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                             |<-Map 17 [CONTAINS]
                                                Reduce Output Operator [RS_37]
                                                   key expressions:_col0 (type: string), _col1 (type: string)
                                                   Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                   sort order:++
                                                   Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                   Group By Operator [GBY_36]
                                                      keys:_col0 (type: string), _col1 (type: string)
                                                      outputColumnNames:["_col0","_col1"]
                                                      Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                      Select Operator [SEL_32]
                                                         outputColumnNames:["_col0","_col1"]
                                                         Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                         Filter Operator [FIL_82]
                                                            predicate:value is not null (type: boolean)
                                                            Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                            TableScan [TS_31]
                                                               alias:y
                                                               Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 32 <- Union 31 (SIMPLE_EDGE)
Map 11 <- Union 8 (CONTAINS)
Reducer 14 <- Map 13 (SIMPLE_EDGE), Reducer 20 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 30 <- Union 29 (SIMPLE_EDGE), Union 31 (CONTAINS)
Reducer 25 <- Map 24 (SIMPLE_EDGE), Reducer 33 (SIMPLE_EDGE), Union 5 (CONTAINS)
Map 22 <- Union 18 (CONTAINS)
Map 21 <- Union 16 (CONTAINS)
Map 34 <- Union 27 (CONTAINS)
Reducer 10 <- Map 12 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
Reducer 33 <- Map 37 (SIMPLE_EDGE), Reducer 32 (SIMPLE_EDGE)
Reducer 20 <- Map 23 (SIMPLE_EDGE), Reducer 19 (SIMPLE_EDGE)
Map 36 <- Union 31 (CONTAINS)
Map 35 <- Union 29 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
Reducer 19 <- Union 18 (SIMPLE_EDGE)
Reducer 6 <- Union 5 (SIMPLE_EDGE)
Reducer 9 <- Union 8 (SIMPLE_EDGE)
Reducer 17 <- Union 16 (SIMPLE_EDGE), Union 18 (CONTAINS)
Map 15 <- Union 16 (CONTAINS)
Reducer 28 <- Union 27 (SIMPLE_EDGE), Union 29 (CONTAINS)
Map 26 <- Union 27 (CONTAINS)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 10 (SIMPLE_EDGE), Union 3 (CONTAINS)
Map 7 <- Union 8 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 6
         File Output Operator [FS_122]
            compressed:false
            Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_120]
            |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            |<-Union 5 [SIMPLE_EDGE]
               |<-Reducer 25 [CONTAINS]
               |  Reduce Output Operator [RS_119]
               |     key expressions:_col0 (type: string), _col1 (type: string)
               |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |     sort order:++
               |     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |     Group By Operator [GBY_118]
               |        keys:_col0 (type: string), _col1 (type: string)
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |        Select Operator [SEL_114]
               |           outputColumnNames:["_col0","_col1"]
               |           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           Merge Join Operator [MERGEJOIN_170]
               |           |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |  keys:{"1":"_col2 (type: string)","0":"_col0 (type: string)"}
               |           |  outputColumnNames:["_col1","_col4"]
               |           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           |<-Map 24 [SIMPLE_EDGE]
               |           |  Reduce Output Operator [RS_110]
               |           |     key expressions:_col0 (type: string)
               |           |     Map-reduce partition columns:_col0 (type: string)
               |           |     sort order:+
               |           |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |     value expressions:_col1 (type: string)
               |           |     Select Operator [SEL_71]
               |           |        outputColumnNames:["_col0","_col1"]
               |           |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |        Filter Operator [FIL_159]
               |           |           predicate:key is not null (type: boolean)
               |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |           TableScan [TS_70]
               |           |              alias:y
               |           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |<-Reducer 33 [SIMPLE_EDGE]
               |              Reduce Output Operator [RS_112]
               |                 key expressions:_col2 (type: string)
               |                 Map-reduce partition columns:_col2 (type: string)
               |                 sort order:+
               |                 Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
               |                 Merge Join Operator [MERGEJOIN_169]
               |                 |  condition map:[{"":"Inner Join 0 to 1"}]
               |                 |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
               |                 |  outputColumnNames:["_col2"]
               |                 |  Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
               |                 |<-Map 37 [SIMPLE_EDGE]
               |                 |  Reduce Output Operator [RS_106]
               |                 |     key expressions:_col1 (type: string)
               |                 |     Map-reduce partition columns:_col1 (type: string)
               |                 |     sort order:+
               |                 |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                 |     value expressions:_col0 (type: string)
               |                 |     Select Operator [SEL_102]
               |                 |        outputColumnNames:["_col0","_col1"]
               |                 |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                 |        Filter Operator [FIL_164]
               |                 |           predicate:(value is not null and key is not null) (type: boolean)
               |                 |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                 |           TableScan [TS_101]
               |                 |              alias:x
               |                 |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |                 |<-Reducer 32 [SIMPLE_EDGE]
               |                    Reduce Output Operator [RS_104]
               |                       key expressions:_col1 (type: string)
               |                       Map-reduce partition columns:_col1 (type: string)
               |                       sort order:+
               |                       Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
               |                       Select Operator [SEL_100]
               |                          outputColumnNames:["_col1"]
               |                          Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
               |                          Group By Operator [GBY_99]
               |                          |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |                          |  outputColumnNames:["_col0","_col1"]
               |                          |  Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
               |                          |<-Union 31 [SIMPLE_EDGE]
               |                             |<-Reducer 30 [CONTAINS]
               |                             |  Reduce Output Operator [RS_98]
               |                             |     key expressions:_col0 (type: string), _col1 (type: string)
               |                             |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                             |     sort order:++
               |                             |     Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |                             |     Group By Operator [GBY_97]
               |                             |        keys:_col0 (type: string), _col1 (type: string)
               |                             |        outputColumnNames:["_col0","_col1"]
               |                             |        Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |                             |        Group By Operator [GBY_90]
               |                             |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |                             |        |  outputColumnNames:["_col0","_col1"]
               |                             |        |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
               |                             |        |<-Union 29 [SIMPLE_EDGE]
               |                             |           |<-Map 35 [CONTAINS]
               |                             |           |  Reduce Output Operator [RS_89]
               |                             |           |     key expressions:_col0 (type: string), _col1 (type: string)
               |                             |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                             |           |     sort order:++
               |                             |           |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |                             |           |     Group By Operator [GBY_88]
               |                             |           |        keys:_col0 (type: string), _col1 (type: string)
               |                             |           |        outputColumnNames:["_col0","_col1"]
               |                             |           |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |                             |           |        Select Operator [SEL_84]
               |                             |           |           outputColumnNames:["_col0","_col1"]
               |                             |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                             |           |           Filter Operator [FIL_162]
               |                             |           |              predicate:value is not null (type: boolean)
               |                             |           |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                             |           |              TableScan [TS_83]
               |                             |           |                 alias:y
               |                             |           |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |                             |           |<-Reducer 28 [CONTAINS]
               |                             |              Reduce Output Operator [RS_89]
               |                             |                 key expressions:_col0 (type: string), _col1 (type: string)
               |                             |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                             |                 sort order:++
               |                             |                 Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |                             |                 Group By Operator [GBY_88]
               |                             |                    keys:_col0 (type: string), _col1 (type: string)
               |                             |                    outputColumnNames:["_col0","_col1"]
               |                             |                    Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |                             |                    Group By Operator [GBY_81]
               |                             |                    |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |                             |                    |  outputColumnNames:["_col0","_col1"]
               |                             |                    |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |                             |                    |<-Union 27 [SIMPLE_EDGE]
               |                             |                       |<-Map 34 [CONTAINS]
               |                             |                       |  Reduce Output Operator [RS_80]
               |                             |                       |     key expressions:_col0 (type: string), _col1 (type: string)
               |                             |                       |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                             |                       |     sort order:++
               |                             |                       |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                             |                       |     Group By Operator [GBY_79]
               |                             |                       |        keys:_col0 (type: string), _col1 (type: string)
               |                             |                       |        outputColumnNames:["_col0","_col1"]
               |                             |                       |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                             |                       |        Select Operator [SEL_75]
               |                             |                       |           outputColumnNames:["_col0","_col1"]
               |                             |                       |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                             |                       |           Filter Operator [FIL_161]
               |                             |                       |              predicate:value is not null (type: boolean)
               |                             |                       |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                             |                       |              TableScan [TS_74]
               |                             |                       |                 alias:y
               |                             |                       |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |                             |                       |<-Map 26 [CONTAINS]
               |                             |                          Reduce Output Operator [RS_80]
               |                             |                             key expressions:_col0 (type: string), _col1 (type: string)
               |                             |                             Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                             |                             sort order:++
               |                             |                             Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                             |                             Group By Operator [GBY_79]
               |                             |                                keys:_col0 (type: string), _col1 (type: string)
               |                             |                                outputColumnNames:["_col0","_col1"]
               |                             |                                Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                             |                                Select Operator [SEL_73]
               |                             |                                   outputColumnNames:["_col0","_col1"]
               |                             |                                   Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |                             |                                   Filter Operator [FIL_160]
               |                             |                                      predicate:value is not null (type: boolean)
               |                             |                                      Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |                             |                                      TableScan [TS_72]
               |                             |                                         alias:x
               |                             |                                         Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |                             |<-Map 36 [CONTAINS]
               |                                Reduce Output Operator [RS_98]
               |                                   key expressions:_col0 (type: string), _col1 (type: string)
               |                                   Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                                   sort order:++
               |                                   Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |                                   Group By Operator [GBY_97]
               |                                      keys:_col0 (type: string), _col1 (type: string)
               |                                      outputColumnNames:["_col0","_col1"]
               |                                      Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |                                      Select Operator [SEL_93]
               |                                         outputColumnNames:["_col0","_col1"]
               |                                         Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                                         Filter Operator [FIL_163]
               |                                            predicate:value is not null (type: boolean)
               |                                            Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                                            TableScan [TS_92]
               |                                               alias:y
               |                                               Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Reducer 4 [CONTAINS]
                  Reduce Output Operator [RS_119]
                     key expressions:_col0 (type: string), _col1 (type: string)
                     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                     sort order:++
                     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator [GBY_118]
                        keys:_col0 (type: string), _col1 (type: string)
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator [GBY_68]
                        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                        |<-Union 3 [SIMPLE_EDGE]
                           |<-Reducer 14 [CONTAINS]
                           |  Reduce Output Operator [RS_67]
                           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |     sort order:++
                           |     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                           |     Group By Operator [GBY_66]
                           |        keys:_col0 (type: string), _col1 (type: string)
                           |        outputColumnNames:["_col0","_col1"]
                           |        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                           |        Select Operator [SEL_62]
                           |           outputColumnNames:["_col0","_col1"]
                           |           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |           Merge Join Operator [MERGEJOIN_168]
                           |           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |           |  keys:{"1":"_col2 (type: string)","0":"_col0 (type: string)"}
                           |           |  outputColumnNames:["_col1","_col4"]
                           |           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |           |<-Map 13 [SIMPLE_EDGE]
                           |           |  Reduce Output Operator [RS_58]
                           |           |     key expressions:_col0 (type: string)
                           |           |     Map-reduce partition columns:_col0 (type: string)
                           |           |     sort order:+
                           |           |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |     value expressions:_col1 (type: string)
                           |           |     Select Operator [SEL_28]
                           |           |        outputColumnNames:["_col0","_col1"]
                           |           |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |        Filter Operator [FIL_154]
                           |           |           predicate:key is not null (type: boolean)
                           |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |           TableScan [TS_27]
                           |           |              alias:y
                           |           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |           |<-Reducer 20 [SIMPLE_EDGE]
                           |              Reduce Output Operator [RS_60]
                           |                 key expressions:_col2 (type: string)
                           |                 Map-reduce partition columns:_col2 (type: string)
                           |                 sort order:+
                           |                 Statistics:Num rows: 209 Data size: 2208 Basic stats: COMPLETE Column stats: NONE
                           |                 Merge Join Operator [MERGEJOIN_167]
                           |                 |  condition map:[{"":"Inner Join 0 to 1"}]
                           |                 |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                           |                 |  outputColumnNames:["_col2"]
                           |                 |  Statistics:Num rows: 209 Data size: 2208 Basic stats: COMPLETE Column stats: NONE
                           |                 |<-Map 23 [SIMPLE_EDGE]
                           |                 |  Reduce Output Operator [RS_54]
                           |                 |     key expressions:_col1 (type: string)
                           |                 |     Map-reduce partition columns:_col1 (type: string)
                           |                 |     sort order:+
                           |                 |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |                 |     value expressions:_col0 (type: string)
                           |                 |     Select Operator [SEL_50]
                           |                 |        outputColumnNames:["_col0","_col1"]
                           |                 |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |                 |        Filter Operator [FIL_158]
                           |                 |           predicate:(value is not null and key is not null) (type: boolean)
                           |                 |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |                 |           TableScan [TS_49]
                           |                 |              alias:x
                           |                 |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |                 |<-Reducer 19 [SIMPLE_EDGE]
                           |                    Reduce Output Operator [RS_52]
                           |                       key expressions:_col1 (type: string)
                           |                       Map-reduce partition columns:_col1 (type: string)
                           |                       sort order:+
                           |                       Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |                       Select Operator [SEL_48]
                           |                          outputColumnNames:["_col1"]
                           |                          Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |                          Group By Operator [GBY_47]
                           |                          |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |                          |  outputColumnNames:["_col0","_col1"]
                           |                          |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |                          |<-Union 18 [SIMPLE_EDGE]
                           |                             |<-Map 22 [CONTAINS]
                           |                             |  Reduce Output Operator [RS_46]
                           |                             |     key expressions:_col0 (type: string), _col1 (type: string)
                           |                             |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                             |     sort order:++
                           |                             |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                             |     Group By Operator [GBY_45]
                           |                             |        keys:_col0 (type: string), _col1 (type: string)
                           |                             |        outputColumnNames:["_col0","_col1"]
                           |                             |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                             |        Select Operator [SEL_41]
                           |                             |           outputColumnNames:["_col0","_col1"]
                           |                             |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                             |           Filter Operator [FIL_157]
                           |                             |              predicate:value is not null (type: boolean)
                           |                             |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                             |              TableScan [TS_40]
                           |                             |                 alias:y
                           |                             |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |                             |<-Reducer 17 [CONTAINS]
                           |                                Reduce Output Operator [RS_46]
                           |                                   key expressions:_col0 (type: string), _col1 (type: string)
                           |                                   Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                                   sort order:++
                           |                                   Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                                   Group By Operator [GBY_45]
                           |                                      keys:_col0 (type: string), _col1 (type: string)
                           |                                      outputColumnNames:["_col0","_col1"]
                           |                                      Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                                      Group By Operator [GBY_38]
                           |                                      |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |                                      |  outputColumnNames:["_col0","_col1"]
                           |                                      |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |                                      |<-Union 16 [SIMPLE_EDGE]
                           |                                         |<-Map 21 [CONTAINS]
                           |                                         |  Reduce Output Operator [RS_37]
                           |                                         |     key expressions:_col0 (type: string), _col1 (type: string)
                           |                                         |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                                         |     sort order:++
                           |                                         |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                                         |     Group By Operator [GBY_36]
                           |                                         |        keys:_col0 (type: string), _col1 (type: string)
                           |                                         |        outputColumnNames:["_col0","_col1"]
                           |                                         |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                                         |        Select Operator [SEL_32]
                           |                                         |           outputColumnNames:["_col0","_col1"]
                           |                                         |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                                         |           Filter Operator [FIL_156]
                           |                                         |              predicate:value is not null (type: boolean)
                           |                                         |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                                         |              TableScan [TS_31]
                           |                                         |                 alias:y
                           |                                         |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |                                         |<-Map 15 [CONTAINS]
                           |                                            Reduce Output Operator [RS_37]
                           |                                               key expressions:_col0 (type: string), _col1 (type: string)
                           |                                               Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                                               sort order:++
                           |                                               Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                                               Group By Operator [GBY_36]
                           |                                                  keys:_col0 (type: string), _col1 (type: string)
                           |                                                  outputColumnNames:["_col0","_col1"]
                           |                                                  Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                                                  Select Operator [SEL_30]
                           |                                                     outputColumnNames:["_col0","_col1"]
                           |                                                     Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |                                                     Filter Operator [FIL_155]
                           |                                                        predicate:value is not null (type: boolean)
                           |                                                        Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |                                                        TableScan [TS_29]
                           |                                                           alias:x
                           |                                                           Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |<-Reducer 2 [CONTAINS]
                              Reduce Output Operator [RS_67]
                                 key expressions:_col0 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                                 Group By Operator [GBY_66]
                                    keys:_col0 (type: string), _col1 (type: string)
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                                    Select Operator [SEL_26]
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                                       Merge Join Operator [MERGEJOIN_166]
                                       |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |  keys:{"1":"_col2 (type: string)","0":"_col0 (type: string)"}
                                       |  outputColumnNames:["_col1","_col4"]
                                       |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                                       |<-Map 1 [SIMPLE_EDGE]
                                       |  Reduce Output Operator [RS_22]
                                       |     key expressions:_col0 (type: string)
                                       |     Map-reduce partition columns:_col0 (type: string)
                                       |     sort order:+
                                       |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                       |     value expressions:_col1 (type: string)
                                       |     Select Operator [SEL_1]
                                       |        outputColumnNames:["_col0","_col1"]
                                       |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                       |        Filter Operator [FIL_150]
                                       |           predicate:key is not null (type: boolean)
                                       |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                       |           TableScan [TS_0]
                                       |              alias:y
                                       |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                       |<-Reducer 10 [SIMPLE_EDGE]
                                          Reduce Output Operator [RS_24]
                                             key expressions:_col2 (type: string)
                                             Map-reduce partition columns:_col2 (type: string)
                                             sort order:+
                                             Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                                             Merge Join Operator [MERGEJOIN_165]
                                             |  condition map:[{"":"Inner Join 0 to 1"}]
                                             |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                                             |  outputColumnNames:["_col2"]
                                             |  Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                                             |<-Map 12 [SIMPLE_EDGE]
                                             |  Reduce Output Operator [RS_18]
                                             |     key expressions:_col1 (type: string)
                                             |     Map-reduce partition columns:_col1 (type: string)
                                             |     sort order:+
                                             |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                             |     value expressions:_col0 (type: string)
                                             |     Select Operator [SEL_14]
                                             |        outputColumnNames:["_col0","_col1"]
                                             |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                             |        Filter Operator [FIL_153]
                                             |           predicate:(value is not null and key is not null) (type: boolean)
                                             |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                             |           TableScan [TS_13]
                                             |              alias:x
                                             |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                             |<-Reducer 9 [SIMPLE_EDGE]
                                                Reduce Output Operator [RS_16]
                                                   key expressions:_col1 (type: string)
                                                   Map-reduce partition columns:_col1 (type: string)
                                                   sort order:+
                                                   Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                                   Select Operator [SEL_12]
                                                      outputColumnNames:["_col1"]
                                                      Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                                      Group By Operator [GBY_11]
                                                      |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                                      |  outputColumnNames:["_col0","_col1"]
                                                      |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                                      |<-Union 8 [SIMPLE_EDGE]
                                                         |<-Map 11 [CONTAINS]
                                                         |  Reduce Output Operator [RS_10]
                                                         |     key expressions:_col0 (type: string), _col1 (type: string)
                                                         |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                         |     sort order:++
                                                         |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                         |     Group By Operator [GBY_9]
                                                         |        keys:_col0 (type: string), _col1 (type: string)
                                                         |        outputColumnNames:["_col0","_col1"]
                                                         |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                         |        Select Operator [SEL_5]
                                                         |           outputColumnNames:["_col0","_col1"]
                                                         |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                         |           Filter Operator [FIL_152]
                                                         |              predicate:value is not null (type: boolean)
                                                         |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                         |              TableScan [TS_4]
                                                         |                 alias:y
                                                         |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                         |<-Map 7 [CONTAINS]
                                                            Reduce Output Operator [RS_10]
                                                               key expressions:_col0 (type: string), _col1 (type: string)
                                                               Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                               sort order:++
                                                               Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                               Group By Operator [GBY_9]
                                                                  keys:_col0 (type: string), _col1 (type: string)
                                                                  outputColumnNames:["_col0","_col1"]
                                                                  Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                                  Select Operator [SEL_3]
                                                                     outputColumnNames:["_col0","_col1"]
                                                                     Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                                                     Filter Operator [FIL_151]
                                                                        predicate:value is not null (type: boolean)
                                                                        Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                                                        TableScan [TS_2]
                                                                           alias:x
                                                                           Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 2 <- Map 1 (BROADCAST_EDGE), Map 3 (BROADCAST_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Map 2
         File Output Operator [FS_19]
            compressed:false
            Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_18]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator [MAPJOIN_29]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"Map 1":"_col0 (type: string)","Map 2":"_col3 (type: string)"}
               |  outputColumnNames:["_col1","_col2","_col5"]
               |  Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [BROADCAST_EDGE]
               |  Reduce Output Operator [RS_14]
               |     key expressions:_col0 (type: string)
               |     Map-reduce partition columns:_col0 (type: string)
               |     sort order:+
               |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:_col1 (type: string)
               |     Select Operator [SEL_1]
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |        Filter Operator [FIL_25]
               |           predicate:key is not null (type: boolean)
               |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           TableScan [TS_0]
               |              alias:y
               |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Map Join Operator [MAPJOIN_28]
                  |  condition map:[{"":"Inner Join 0 to 1"}]
                  |  keys:{"Map 2":"_col0 (type: string)","Map 3":"_col1 (type: string)"}
                  |  outputColumnNames:["_col0","_col3"]
                  |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 3 [BROADCAST_EDGE]
                  |  Reduce Output Operator [RS_10]
                  |     key expressions:_col1 (type: string)
                  |     Map-reduce partition columns:_col1 (type: string)
                  |     sort order:+
                  |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                  |     value expressions:_col0 (type: string)
                  |     Select Operator [SEL_6]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                  |        Filter Operator [FIL_27]
                  |           predicate:(value is not null and key is not null) (type: boolean)
                  |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                  |           TableScan [TS_5]
                  |              alias:x
                  |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                  |<-Select Operator [SEL_4]
                        outputColumnNames:["_col0"]
                        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                        Filter Operator [FIL_26]
                           predicate:value is not null (type: boolean)
                           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           TableScan [TS_2]
                              alias:z
                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
select 
ss.k1,sr.k2,cs.k3,count(ss.v1),count(sr.v2),count(cs.v3)
FROM 
ss,sr,cs,src d1,src d2,src d3,src1,srcpart
where
    ss.k1 = d1.key 
and sr.k1 = d2.key 
and cs.k1 = d3.key 
and ss.k2 = sr.k2
and ss.k3 = sr.k3
and ss.v1 = src1.value
and ss.v2 = srcpart.value
and sr.v2 = cs.v2
and sr.v3 = cs.v3
and ss.v3='ssv3'
and sr.v1='srv1'
and src1.key = 'src1key'
and srcpart.key = 'srcpartkey'
and d1.value = 'd1value'
and d2.value in ('2000Q1','2000Q2','2000Q3')
and d3.value in ('2000Q1','2000Q2','2000Q3')
group by 
ss.k1,sr.k2,cs.k3
order by 
ss.k1,sr.k2,cs.k3
limit 100
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 2 <- Map 1 (BROADCAST_EDGE)
Map 10 <- Map 9 (BROADCAST_EDGE)
Map 5 <- Map 10 (BROADCAST_EDGE), Map 2 (BROADCAST_EDGE), Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
Reducer 7 <- Reducer 6 (SIMPLE_EDGE)
Reducer 6 <- Map 5 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:100
      Stage-1
         Reducer 7
         File Output Operator [FS_71]
            compressed:false
            Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Limit [LIM_70]
               Number of rows:100
               Statistics:Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
               Select Operator [SEL_69]
               |  outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
               |  Statistics:Num rows: 402 Data size: 4276 Basic stats: COMPLETE Column stats: NONE
               |<-Reducer 6 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_68]
                     key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                     sort order:+++
                     Statistics:Num rows: 402 Data size: 4276 Basic stats: COMPLETE Column stats: NONE
                     value expressions:_col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
                     Group By Operator [GBY_66]
                     |  aggregations:["count(VALUE._col0)","count(VALUE._col1)","count(VALUE._col2)"]
                     |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
                     |  outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                     |  Statistics:Num rows: 402 Data size: 4276 Basic stats: COMPLETE Column stats: NONE
                     |<-Map 5 [SIMPLE_EDGE]
                        Reduce Output Operator [RS_65]
                           key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                           Map-reduce partition columns:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                           sort order:+++
                           Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                           value expressions:_col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
                           Group By Operator [GBY_64]
                              aggregations:["count(_col3)","count(_col4)","count(_col5)"]
                              keys:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                              outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                              Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                              Select Operator [SEL_62]
                                 outputColumnNames:["_col0","_col1","_col2","_col3","_col4","_col5"]
                                 Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                                 Map Join Operator [MAPJOIN_113]
                                 |  condition map:[{"":"Inner Join 0 to 1"}]
                                 |  keys:{"Map 2":"_col1 (type: string), _col3 (type: string)","Map 5":"_col15 (type: string), _col17 (type: string)"}
                                 |  outputColumnNames:["_col2","_col3","_col12","_col13","_col20","_col21"]
                                 |  Statistics:Num rows: 804 Data size: 8552 Basic stats: COMPLETE Column stats: NONE
                                 |<-Map 2 [BROADCAST_EDGE]
                                 |  Reduce Output Operator [RS_58]
                                 |     key expressions:_col1 (type: string), _col3 (type: string)
                                 |     Map-reduce partition columns:_col1 (type: string), _col3 (type: string)
                                 |     sort order:++
                                 |     Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                 |     value expressions:_col2 (type: string)
                                 |     Map Join Operator [MAPJOIN_107]
                                 |     |  condition map:[{"":"Inner Join 0 to 1"}]
                                 |     |  keys:{"Map 1":"_col0 (type: string)","Map 2":"_col0 (type: string)"}
                                 |     |  outputColumnNames:["_col1","_col2","_col3"]
                                 |     |  Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                 |     |<-Map 1 [BROADCAST_EDGE]
                                 |     |  Reduce Output Operator [RS_53]
                                 |     |     key expressions:_col0 (type: string)
                                 |     |     Map-reduce partition columns:_col0 (type: string)
                                 |     |     sort order:+
                                 |     |     Statistics:Num rows: 22 Data size: 762 Basic stats: COMPLETE Column stats: NONE
                                 |     |     value expressions:_col1 (type: string), _col2 (type: string), _col3 (type: string)
                                 |     |     Select Operator [SEL_1]
                                 |     |        outputColumnNames:["_col0","_col1","_col2","_col3"]
                                 |     |        Statistics:Num rows: 22 Data size: 762 Basic stats: COMPLETE Column stats: NONE
                                 |     |        Filter Operator [FIL_99]
                                 |     |           predicate:((k1 is not null and v2 is not null) and v3 is not null) (type: boolean)
                                 |     |           Statistics:Num rows: 22 Data size: 762 Basic stats: COMPLETE Column stats: NONE
                                 |     |           TableScan [TS_0]
                                 |     |              alias:cs
                                 |     |              Statistics:Num rows: 170 Data size: 5890 Basic stats: COMPLETE Column stats: NONE
                                 |     |<-Select Operator [SEL_4]
                                 |           outputColumnNames:["_col0"]
                                 |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                 |           Filter Operator [FIL_100]
                                 |              predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null) (type: boolean)
                                 |              Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                 |              TableScan [TS_2]
                                 |                 alias:d1
                                 |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                 |<-Select Operator [SEL_51]
                                       outputColumnNames:["_col14","_col15","_col17","_col6","_col7"]
                                       Statistics:Num rows: 731 Data size: 7775 Basic stats: COMPLETE Column stats: NONE
                                       Map Join Operator [MAPJOIN_112]
                                       |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |  keys:{"Map 10":"_col2 (type: string), _col4 (type: string)","Map 5":"_col8 (type: string), _col10 (type: string)"}
                                       |  outputColumnNames:["_col6","_col7","_col14","_col15","_col17"]
                                       |  Statistics:Num rows: 731 Data size: 7775 Basic stats: COMPLETE Column stats: NONE
                                       |<-Map 10 [BROADCAST_EDGE]
                                       |  Reduce Output Operator [RS_49]
                                       |     key expressions:_col2 (type: string), _col4 (type: string)
                                       |     Map-reduce partition columns:_col2 (type: string), _col4 (type: string)
                                       |     sort order:++
                                       |     Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                       |     value expressions:_col3 (type: string), _col5 (type: string)
                                       |     Map Join Operator [MAPJOIN_111]
                                       |     |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |     |  keys:{"Map 10":"_col0 (type: string)","Map 9":"_col0 (type: string)"}
                                       |     |  outputColumnNames:["_col2","_col3","_col4","_col5"]
                                       |     |  Statistics:Num rows: 137 Data size: 1460 Basic stats: COMPLETE Column stats: NONE
                                       |     |<-Map 9 [BROADCAST_EDGE]
                                       |     |  Reduce Output Operator [RS_36]
                                       |     |     key expressions:_col0 (type: string)
                                       |     |     Map-reduce partition columns:_col0 (type: string)
                                       |     |     sort order:+
                                       |     |     Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                       |     |     value expressions:_col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                                       |     |     Select Operator [SEL_31]
                                       |     |        outputColumnNames:["_col0","_col2","_col3","_col4","_col5"]
                                       |     |        Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                       |     |        Filter Operator [FIL_105]
                                       |     |           predicate:((((((v1 = 'srv1') and k1 is not null) and k2 is not null) and k3 is not null) and v2 is not null) and v3 is not null) (type: boolean)
                                       |     |           Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                       |     |           TableScan [TS_29]
                                       |     |              alias:sr
                                       |     |              Statistics:Num rows: 85 Data size: 2945 Basic stats: COMPLETE Column stats: NONE
                                       |     |<-Select Operator [SEL_34]
                                       |           outputColumnNames:["_col0"]
                                       |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                       |           Filter Operator [FIL_106]
                                       |              predicate:((value) IN ('2000Q1', '2000Q2', '2000Q3') and key is not null) (type: boolean)
                                       |              Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                       |              TableScan [TS_32]
                                       |                 alias:d1
                                       |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                       |<-Map Join Operator [MAPJOIN_110]
                                          |  condition map:[{"":"Inner Join 0 to 1"}]
                                          |  keys:{"Map 3":"_col1 (type: string)","Map 5":"_col5 (type: string)"}
                                          |  outputColumnNames:["_col6","_col7","_col8","_col10"]
                                          |  Statistics:Num rows: 665 Data size: 7069 Basic stats: COMPLETE Column stats: NONE
                                          |<-Map 3 [BROADCAST_EDGE]
                                          |  Reduce Output Operator [RS_42]
                                          |     key expressions:_col1 (type: string)
                                          |     Map-reduce partition columns:_col1 (type: string)
                                          |     sort order:+
                                          |     Statistics:Num rows: 6 Data size: 45 Basic stats: COMPLETE Column stats: NONE
                                          |     Select Operator [SEL_7]
                                          |        outputColumnNames:["_col1"]
                                          |        Statistics:Num rows: 6 Data size: 45 Basic stats: COMPLETE Column stats: NONE
                                          |        Filter Operator [FIL_101]
                                          |           predicate:((key = 'src1key') and value is not null) (type: boolean)
                                          |           Statistics:Num rows: 6 Data size: 45 Basic stats: COMPLETE Column stats: NONE
                                          |           TableScan [TS_5]
                                          |              alias:src1
                                          |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                          |<-Map Join Operator [MAPJOIN_109]
                                             |  condition map:[{"":"Inner Join 0 to 1"}]
                                             |  keys:{"Map 5":"_col2 (type: string)","Map 4":"_col0 (type: string)"}
                                             |  outputColumnNames:["_col4","_col5","_col6","_col8"]
                                             |  Statistics:Num rows: 605 Data size: 6427 Basic stats: COMPLETE Column stats: NONE
                                             |<-Map 4 [BROADCAST_EDGE]
                                             |  Reduce Output Operator [RS_24]
                                             |     key expressions:_col0 (type: string)
                                             |     Map-reduce partition columns:_col0 (type: string)
                                             |     sort order:+
                                             |     Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                             |     Select Operator [SEL_10]
                                             |        outputColumnNames:["_col0"]
                                             |        Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                             |        Filter Operator [FIL_102]
                                             |           predicate:((value = 'd1value') and key is not null) (type: boolean)
                                             |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                                             |           TableScan [TS_8]
                                             |              alias:d1
                                             |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                             |<-Map Join Operator [MAPJOIN_108]
                                                |  condition map:[{"":"Inner Join 0 to 1"}]
                                                |  keys:{"Map 5":"_col1 (type: string)","Map 8":"_col3 (type: string)"}
                                                |  outputColumnNames:["_col2","_col3","_col4","_col6"]
                                                |  Statistics:Num rows: 550 Data size: 5843 Basic stats: COMPLETE Column stats: NONE
                                                |<-Map 8 [BROADCAST_EDGE]
                                                |  Reduce Output Operator [RS_20]
                                                |     key expressions:_col3 (type: string)
                                                |     Map-reduce partition columns:_col3 (type: string)
                                                |     sort order:+
                                                |     Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                                |     value expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: string)
                                                |     Select Operator [SEL_16]
                                                |        outputColumnNames:["_col0","_col1","_col2","_col3","_col4"]
                                                |        Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                                |        Filter Operator [FIL_104]
                                                |           predicate:((((((v3 = 'ssv3') and v2 is not null) and k1 is not null) and v1 is not null) and k2 is not null) and k3 is not null) (type: boolean)
                                                |           Statistics:Num rows: 2 Data size: 69 Basic stats: COMPLETE Column stats: NONE
                                                |           TableScan [TS_14]
                                                |              alias:ss
                                                |              Statistics:Num rows: 85 Data size: 2945 Basic stats: COMPLETE Column stats: NONE
                                                |<-Select Operator [SEL_13]
                                                      outputColumnNames:["_col1"]
                                                      Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                      Filter Operator [FIL_103]
                                                         predicate:((key = 'srcpartkey') and value is not null) (type: boolean)
                                                         Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                         TableScan [TS_11]
                                                            alias:srcpart
                                                            Statistics:Num rows: 2000 Data size: 21248 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, z.value, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 3 <- Union 2 (SIMPLE_EDGE)
Reducer 12 <- Map 14 (BROADCAST_EDGE), Union 11 (SIMPLE_EDGE)
Map 13 <- Union 11 (CONTAINS)
Map 1 <- Reducer 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
Map 10 <- Union 11 (CONTAINS)
Map 4 <- Union 5 (CONTAINS)
Map 7 <- Union 5 (CONTAINS)
Reducer 6 <- Map 8 (BROADCAST_EDGE), Union 5 (SIMPLE_EDGE)
Map 9 <- Reducer 12 (BROADCAST_EDGE), Union 2 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 3
         File Output Operator [FS_61]
            compressed:false
            Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_59]
            |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            |<-Union 2 [SIMPLE_EDGE]
               |<-Map 1 [CONTAINS]
               |  Reduce Output Operator [RS_58]
               |     key expressions:_col0 (type: string), _col1 (type: string)
               |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |     sort order:++
               |     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |     Group By Operator [GBY_57]
               |        keys:_col0 (type: string), _col1 (type: string)
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |        Select Operator [SEL_26]
               |           outputColumnNames:["_col0","_col1"]
               |           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           Map Join Operator [MAPJOIN_85]
               |           |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |  keys:{"Map 1":"_col0 (type: string)","Reducer 6":"_col2 (type: string)"}
               |           |  outputColumnNames:["_col2","_col3"]
               |           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           |<-Reducer 6 [BROADCAST_EDGE]
               |           |  Reduce Output Operator [RS_24]
               |           |     key expressions:_col2 (type: string)
               |           |     Map-reduce partition columns:_col2 (type: string)
               |           |     sort order:+
               |           |     Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
               |           |     value expressions:_col1 (type: string)
               |           |     Map Join Operator [MAPJOIN_84]
               |           |     |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |     |  keys:{"Reducer 6":"_col1 (type: string)","Map 8":"_col1 (type: string)"}
               |           |     |  outputColumnNames:["_col1","_col2"]
               |           |     |  Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
               |           |     |<-Map 8 [BROADCAST_EDGE]
               |           |     |  Reduce Output Operator [RS_18]
               |           |     |     key expressions:_col1 (type: string)
               |           |     |     Map-reduce partition columns:_col1 (type: string)
               |           |     |     sort order:+
               |           |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |           |     |     value expressions:_col0 (type: string)
               |           |     |     Select Operator [SEL_14]
               |           |     |        outputColumnNames:["_col0","_col1"]
               |           |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |           |     |        Filter Operator [FIL_79]
               |           |     |           predicate:(value is not null and key is not null) (type: boolean)
               |           |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |           |     |           TableScan [TS_13]
               |           |     |              alias:x
               |           |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |           |     |<-Select Operator [SEL_12]
               |           |           outputColumnNames:["_col1"]
               |           |           Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |           |           Group By Operator [GBY_11]
               |           |           |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |           |           |  outputColumnNames:["_col0","_col1"]
               |           |           |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |           |           |<-Union 5 [SIMPLE_EDGE]
               |           |              |<-Map 4 [CONTAINS]
               |           |              |  Reduce Output Operator [RS_10]
               |           |              |     key expressions:_col0 (type: string), _col1 (type: string)
               |           |              |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |              |     sort order:++
               |           |              |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |              |     Group By Operator [GBY_9]
               |           |              |        keys:_col0 (type: string), _col1 (type: string)
               |           |              |        outputColumnNames:["_col0","_col1"]
               |           |              |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |              |        Select Operator [SEL_3]
               |           |              |           outputColumnNames:["_col0","_col1"]
               |           |              |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |           |              |           Filter Operator [FIL_77]
               |           |              |              predicate:value is not null (type: boolean)
               |           |              |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |           |              |              TableScan [TS_2]
               |           |              |                 alias:x
               |           |              |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |           |              |<-Map 7 [CONTAINS]
               |           |                 Reduce Output Operator [RS_10]
               |           |                    key expressions:_col0 (type: string), _col1 (type: string)
               |           |                    Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                    sort order:++
               |           |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                    Group By Operator [GBY_9]
               |           |                       keys:_col0 (type: string), _col1 (type: string)
               |           |                       outputColumnNames:["_col0","_col1"]
               |           |                       Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                       Select Operator [SEL_5]
               |           |                          outputColumnNames:["_col0","_col1"]
               |           |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                          Filter Operator [FIL_78]
               |           |                             predicate:value is not null (type: boolean)
               |           |                             Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                             TableScan [TS_4]
               |           |                                alias:y
               |           |                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |<-Select Operator [SEL_1]
               |                 outputColumnNames:["_col0"]
               |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                 Filter Operator [FIL_76]
               |                    predicate:key is not null (type: boolean)
               |                    Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                    TableScan [TS_0]
               |                       alias:y
               |                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Map 9 [CONTAINS]
                  Reduce Output Operator [RS_58]
                     key expressions:_col0 (type: string), _col1 (type: string)
                     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                     sort order:++
                     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator [GBY_57]
                        keys:_col0 (type: string), _col1 (type: string)
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                        Select Operator [SEL_53]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           Map Join Operator [MAPJOIN_87]
                           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |  keys:{"Reducer 12":"_col2 (type: string)","Map 9":"_col0 (type: string)"}
                           |  outputColumnNames:["_col2","_col3"]
                           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |<-Reducer 12 [BROADCAST_EDGE]
                           |  Reduce Output Operator [RS_51]
                           |     key expressions:_col2 (type: string)
                           |     Map-reduce partition columns:_col2 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                           |     value expressions:_col1 (type: string)
                           |     Map Join Operator [MAPJOIN_86]
                           |     |  condition map:[{"":"Inner Join 0 to 1"}]
                           |     |  keys:{"Map 14":"_col1 (type: string)","Reducer 12":"_col1 (type: string)"}
                           |     |  outputColumnNames:["_col1","_col2"]
                           |     |  Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                           |     |<-Map 14 [BROADCAST_EDGE]
                           |     |  Reduce Output Operator [RS_45]
                           |     |     key expressions:_col1 (type: string)
                           |     |     Map-reduce partition columns:_col1 (type: string)
                           |     |     sort order:+
                           |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |     |     value expressions:_col0 (type: string)
                           |     |     Select Operator [SEL_41]
                           |     |        outputColumnNames:["_col0","_col1"]
                           |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |     |        Filter Operator [FIL_83]
                           |     |           predicate:(value is not null and key is not null) (type: boolean)
                           |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |     |           TableScan [TS_40]
                           |     |              alias:x
                           |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |     |<-Select Operator [SEL_39]
                           |           outputColumnNames:["_col1"]
                           |           Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |           Group By Operator [GBY_38]
                           |           |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |           |  outputColumnNames:["_col0","_col1"]
                           |           |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |           |<-Union 11 [SIMPLE_EDGE]
                           |              |<-Map 13 [CONTAINS]
                           |              |  Reduce Output Operator [RS_37]
                           |              |     key expressions:_col0 (type: string), _col1 (type: string)
                           |              |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |              |     sort order:++
                           |              |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |              |     Group By Operator [GBY_36]
                           |              |        keys:_col0 (type: string), _col1 (type: string)
                           |              |        outputColumnNames:["_col0","_col1"]
                           |              |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |              |        Select Operator [SEL_32]
                           |              |           outputColumnNames:["_col0","_col1"]
                           |              |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |              |           Filter Operator [FIL_82]
                           |              |              predicate:value is not null (type: boolean)
                           |              |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |              |              TableScan [TS_31]
                           |              |                 alias:y
                           |              |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |              |<-Map 10 [CONTAINS]
                           |                 Reduce Output Operator [RS_37]
                           |                    key expressions:_col0 (type: string), _col1 (type: string)
                           |                    Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                    sort order:++
                           |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                    Group By Operator [GBY_36]
                           |                       keys:_col0 (type: string), _col1 (type: string)
                           |                       outputColumnNames:["_col0","_col1"]
                           |                       Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                       Select Operator [SEL_30]
                           |                          outputColumnNames:["_col0","_col1"]
                           |                          Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |                          Filter Operator [FIL_81]
                           |                             predicate:value is not null (type: boolean)
                           |                             Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |                             TableScan [TS_29]
                           |                                alias:x
                           |                                Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |<-Select Operator [SEL_28]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                 Filter Operator [FIL_80]
                                    predicate:key is not null (type: boolean)
                                    Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                    TableScan [TS_27]
                                       alias:y
                                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 12 <- Union 13 (CONTAINS)
Map 30 <- Union 26 (CONTAINS)
Reducer 23 <- Union 22 (SIMPLE_EDGE), Union 24 (CONTAINS)
Reducer 14 <- Union 13 (SIMPLE_EDGE), Union 15 (CONTAINS)
Map 11 <- Reducer 16 (BROADCAST_EDGE), Union 2 (CONTAINS)
Reducer 25 <- Union 24 (SIMPLE_EDGE), Union 26 (CONTAINS)
Map 21 <- Union 22 (CONTAINS)
Map 1 <- Reducer 8 (BROADCAST_EDGE), Union 2 (CONTAINS)
Map 20 <- Reducer 27 (BROADCAST_EDGE), Union 4 (CONTAINS)
Reducer 5 <- Union 4 (SIMPLE_EDGE)
Map 29 <- Union 24 (CONTAINS)
Reducer 8 <- Map 10 (BROADCAST_EDGE), Union 7 (SIMPLE_EDGE)
Reducer 27 <- Map 31 (BROADCAST_EDGE), Union 26 (SIMPLE_EDGE)
Map 28 <- Union 22 (CONTAINS)
Map 18 <- Union 15 (CONTAINS)
Reducer 16 <- Map 19 (BROADCAST_EDGE), Union 15 (SIMPLE_EDGE)
Map 17 <- Union 13 (CONTAINS)
Reducer 3 <- Union 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
Map 6 <- Union 7 (CONTAINS)
Map 9 <- Union 7 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_122]
            compressed:false
            Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_120]
            |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            |<-Union 4 [SIMPLE_EDGE]
               |<-Map 20 [CONTAINS]
               |  Reduce Output Operator [RS_119]
               |     key expressions:_col0 (type: string), _col1 (type: string)
               |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |     sort order:++
               |     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |     Group By Operator [GBY_118]
               |        keys:_col0 (type: string), _col1 (type: string)
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |        Select Operator [SEL_114]
               |           outputColumnNames:["_col0","_col1"]
               |           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           Map Join Operator [MAPJOIN_170]
               |           |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |  keys:{"Map 20":"_col0 (type: string)","Reducer 27":"_col2 (type: string)"}
               |           |  outputColumnNames:["_col1","_col4"]
               |           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           |<-Reducer 27 [BROADCAST_EDGE]
               |           |  Reduce Output Operator [RS_112]
               |           |     key expressions:_col2 (type: string)
               |           |     Map-reduce partition columns:_col2 (type: string)
               |           |     sort order:+
               |           |     Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
               |           |     Map Join Operator [MAPJOIN_169]
               |           |     |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |     |  keys:{"Map 31":"_col1 (type: string)","Reducer 27":"_col1 (type: string)"}
               |           |     |  outputColumnNames:["_col2"]
               |           |     |  Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
               |           |     |<-Map 31 [BROADCAST_EDGE]
               |           |     |  Reduce Output Operator [RS_106]
               |           |     |     key expressions:_col1 (type: string)
               |           |     |     Map-reduce partition columns:_col1 (type: string)
               |           |     |     sort order:+
               |           |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |           |     |     value expressions:_col0 (type: string)
               |           |     |     Select Operator [SEL_102]
               |           |     |        outputColumnNames:["_col0","_col1"]
               |           |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |           |     |        Filter Operator [FIL_164]
               |           |     |           predicate:(value is not null and key is not null) (type: boolean)
               |           |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |           |     |           TableScan [TS_101]
               |           |     |              alias:x
               |           |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |           |     |<-Select Operator [SEL_100]
               |           |           outputColumnNames:["_col1"]
               |           |           Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
               |           |           Group By Operator [GBY_99]
               |           |           |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |           |           |  outputColumnNames:["_col0","_col1"]
               |           |           |  Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
               |           |           |<-Union 26 [SIMPLE_EDGE]
               |           |              |<-Map 30 [CONTAINS]
               |           |              |  Reduce Output Operator [RS_98]
               |           |              |     key expressions:_col0 (type: string), _col1 (type: string)
               |           |              |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |              |     sort order:++
               |           |              |     Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |           |              |     Group By Operator [GBY_97]
               |           |              |        keys:_col0 (type: string), _col1 (type: string)
               |           |              |        outputColumnNames:["_col0","_col1"]
               |           |              |        Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |           |              |        Select Operator [SEL_93]
               |           |              |           outputColumnNames:["_col0","_col1"]
               |           |              |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |              |           Filter Operator [FIL_163]
               |           |              |              predicate:value is not null (type: boolean)
               |           |              |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |              |              TableScan [TS_92]
               |           |              |                 alias:y
               |           |              |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |              |<-Reducer 25 [CONTAINS]
               |           |                 Reduce Output Operator [RS_98]
               |           |                    key expressions:_col0 (type: string), _col1 (type: string)
               |           |                    Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                    sort order:++
               |           |                    Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |           |                    Group By Operator [GBY_97]
               |           |                       keys:_col0 (type: string), _col1 (type: string)
               |           |                       outputColumnNames:["_col0","_col1"]
               |           |                       Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
               |           |                       Group By Operator [GBY_90]
               |           |                       |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |           |                       |  outputColumnNames:["_col0","_col1"]
               |           |                       |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
               |           |                       |<-Union 24 [SIMPLE_EDGE]
               |           |                          |<-Reducer 23 [CONTAINS]
               |           |                          |  Reduce Output Operator [RS_89]
               |           |                          |     key expressions:_col0 (type: string), _col1 (type: string)
               |           |                          |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                          |     sort order:++
               |           |                          |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                          |     Group By Operator [GBY_88]
               |           |                          |        keys:_col0 (type: string), _col1 (type: string)
               |           |                          |        outputColumnNames:["_col0","_col1"]
               |           |                          |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                          |        Group By Operator [GBY_81]
               |           |                          |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |           |                          |        |  outputColumnNames:["_col0","_col1"]
               |           |                          |        |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |           |                          |        |<-Union 22 [SIMPLE_EDGE]
               |           |                          |           |<-Map 21 [CONTAINS]
               |           |                          |           |  Reduce Output Operator [RS_80]
               |           |                          |           |     key expressions:_col0 (type: string), _col1 (type: string)
               |           |                          |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                          |           |     sort order:++
               |           |                          |           |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                          |           |     Group By Operator [GBY_79]
               |           |                          |           |        keys:_col0 (type: string), _col1 (type: string)
               |           |                          |           |        outputColumnNames:["_col0","_col1"]
               |           |                          |           |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                          |           |        Select Operator [SEL_73]
               |           |                          |           |           outputColumnNames:["_col0","_col1"]
               |           |                          |           |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |           |                          |           |           Filter Operator [FIL_160]
               |           |                          |           |              predicate:value is not null (type: boolean)
               |           |                          |           |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |           |                          |           |              TableScan [TS_72]
               |           |                          |           |                 alias:x
               |           |                          |           |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |           |                          |           |<-Map 28 [CONTAINS]
               |           |                          |              Reduce Output Operator [RS_80]
               |           |                          |                 key expressions:_col0 (type: string), _col1 (type: string)
               |           |                          |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                          |                 sort order:++
               |           |                          |                 Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                          |                 Group By Operator [GBY_79]
               |           |                          |                    keys:_col0 (type: string), _col1 (type: string)
               |           |                          |                    outputColumnNames:["_col0","_col1"]
               |           |                          |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                          |                    Select Operator [SEL_75]
               |           |                          |                       outputColumnNames:["_col0","_col1"]
               |           |                          |                       Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                          |                       Filter Operator [FIL_161]
               |           |                          |                          predicate:value is not null (type: boolean)
               |           |                          |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                          |                          TableScan [TS_74]
               |           |                          |                             alias:y
               |           |                          |                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |                          |<-Map 29 [CONTAINS]
               |           |                             Reduce Output Operator [RS_89]
               |           |                                key expressions:_col0 (type: string), _col1 (type: string)
               |           |                                Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                                sort order:++
               |           |                                Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                                Group By Operator [GBY_88]
               |           |                                   keys:_col0 (type: string), _col1 (type: string)
               |           |                                   outputColumnNames:["_col0","_col1"]
               |           |                                   Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                                   Select Operator [SEL_84]
               |           |                                      outputColumnNames:["_col0","_col1"]
               |           |                                      Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                                      Filter Operator [FIL_162]
               |           |                                         predicate:value is not null (type: boolean)
               |           |                                         Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                                         TableScan [TS_83]
               |           |                                            alias:y
               |           |                                            Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |<-Select Operator [SEL_71]
               |                 outputColumnNames:["_col0","_col1"]
               |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                 Filter Operator [FIL_159]
               |                    predicate:key is not null (type: boolean)
               |                    Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                    TableScan [TS_70]
               |                       alias:y
               |                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Reducer 3 [CONTAINS]
                  Reduce Output Operator [RS_119]
                     key expressions:_col0 (type: string), _col1 (type: string)
                     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                     sort order:++
                     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator [GBY_118]
                        keys:_col0 (type: string), _col1 (type: string)
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator [GBY_68]
                        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                        |<-Union 2 [SIMPLE_EDGE]
                           |<-Map 11 [CONTAINS]
                           |  Reduce Output Operator [RS_67]
                           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |     sort order:++
                           |     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                           |     Group By Operator [GBY_66]
                           |        keys:_col0 (type: string), _col1 (type: string)
                           |        outputColumnNames:["_col0","_col1"]
                           |        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                           |        Select Operator [SEL_62]
                           |           outputColumnNames:["_col0","_col1"]
                           |           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |           Map Join Operator [MAPJOIN_168]
                           |           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |           |  keys:{"Map 11":"_col0 (type: string)","Reducer 16":"_col2 (type: string)"}
                           |           |  outputColumnNames:["_col1","_col4"]
                           |           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |           |<-Reducer 16 [BROADCAST_EDGE]
                           |           |  Reduce Output Operator [RS_60]
                           |           |     key expressions:_col2 (type: string)
                           |           |     Map-reduce partition columns:_col2 (type: string)
                           |           |     sort order:+
                           |           |     Statistics:Num rows: 209 Data size: 2208 Basic stats: COMPLETE Column stats: NONE
                           |           |     Map Join Operator [MAPJOIN_167]
                           |           |     |  condition map:[{"":"Inner Join 0 to 1"}]
                           |           |     |  keys:{"Map 19":"_col1 (type: string)","Reducer 16":"_col1 (type: string)"}
                           |           |     |  outputColumnNames:["_col2"]
                           |           |     |  Statistics:Num rows: 209 Data size: 2208 Basic stats: COMPLETE Column stats: NONE
                           |           |     |<-Map 19 [BROADCAST_EDGE]
                           |           |     |  Reduce Output Operator [RS_54]
                           |           |     |     key expressions:_col1 (type: string)
                           |           |     |     Map-reduce partition columns:_col1 (type: string)
                           |           |     |     sort order:+
                           |           |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |           |     |     value expressions:_col0 (type: string)
                           |           |     |     Select Operator [SEL_50]
                           |           |     |        outputColumnNames:["_col0","_col1"]
                           |           |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |           |     |        Filter Operator [FIL_158]
                           |           |     |           predicate:(value is not null and key is not null) (type: boolean)
                           |           |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |           |     |           TableScan [TS_49]
                           |           |     |              alias:x
                           |           |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |           |     |<-Select Operator [SEL_48]
                           |           |           outputColumnNames:["_col1"]
                           |           |           Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |           |           Group By Operator [GBY_47]
                           |           |           |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |           |           |  outputColumnNames:["_col0","_col1"]
                           |           |           |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |           |           |<-Union 15 [SIMPLE_EDGE]
                           |           |              |<-Reducer 14 [CONTAINS]
                           |           |              |  Reduce Output Operator [RS_46]
                           |           |              |     key expressions:_col0 (type: string), _col1 (type: string)
                           |           |              |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |           |              |     sort order:++
                           |           |              |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |           |              |     Group By Operator [GBY_45]
                           |           |              |        keys:_col0 (type: string), _col1 (type: string)
                           |           |              |        outputColumnNames:["_col0","_col1"]
                           |           |              |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |           |              |        Group By Operator [GBY_38]
                           |           |              |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |           |              |        |  outputColumnNames:["_col0","_col1"]
                           |           |              |        |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |           |              |        |<-Union 13 [SIMPLE_EDGE]
                           |           |              |           |<-Map 12 [CONTAINS]
                           |           |              |           |  Reduce Output Operator [RS_37]
                           |           |              |           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |           |              |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |           |              |           |     sort order:++
                           |           |              |           |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |              |           |     Group By Operator [GBY_36]
                           |           |              |           |        keys:_col0 (type: string), _col1 (type: string)
                           |           |              |           |        outputColumnNames:["_col0","_col1"]
                           |           |              |           |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |              |           |        Select Operator [SEL_30]
                           |           |              |           |           outputColumnNames:["_col0","_col1"]
                           |           |              |           |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |           |              |           |           Filter Operator [FIL_155]
                           |           |              |           |              predicate:value is not null (type: boolean)
                           |           |              |           |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |           |              |           |              TableScan [TS_29]
                           |           |              |           |                 alias:x
                           |           |              |           |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |           |              |           |<-Map 17 [CONTAINS]
                           |           |              |              Reduce Output Operator [RS_37]
                           |           |              |                 key expressions:_col0 (type: string), _col1 (type: string)
                           |           |              |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |           |              |                 sort order:++
                           |           |              |                 Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |              |                 Group By Operator [GBY_36]
                           |           |              |                    keys:_col0 (type: string), _col1 (type: string)
                           |           |              |                    outputColumnNames:["_col0","_col1"]
                           |           |              |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |              |                    Select Operator [SEL_32]
                           |           |              |                       outputColumnNames:["_col0","_col1"]
                           |           |              |                       Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |              |                       Filter Operator [FIL_156]
                           |           |              |                          predicate:value is not null (type: boolean)
                           |           |              |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |              |                          TableScan [TS_31]
                           |           |              |                             alias:y
                           |           |              |                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |           |              |<-Map 18 [CONTAINS]
                           |           |                 Reduce Output Operator [RS_46]
                           |           |                    key expressions:_col0 (type: string), _col1 (type: string)
                           |           |                    Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |           |                    sort order:++
                           |           |                    Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |           |                    Group By Operator [GBY_45]
                           |           |                       keys:_col0 (type: string), _col1 (type: string)
                           |           |                       outputColumnNames:["_col0","_col1"]
                           |           |                       Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |           |                       Select Operator [SEL_41]
                           |           |                          outputColumnNames:["_col0","_col1"]
                           |           |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |                          Filter Operator [FIL_157]
                           |           |                             predicate:value is not null (type: boolean)
                           |           |                             Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |                             TableScan [TS_40]
                           |           |                                alias:y
                           |           |                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |           |<-Select Operator [SEL_28]
                           |                 outputColumnNames:["_col0","_col1"]
                           |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                 Filter Operator [FIL_154]
                           |                    predicate:key is not null (type: boolean)
                           |                    Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                    TableScan [TS_27]
                           |                       alias:y
                           |                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |<-Map 1 [CONTAINS]
                              Reduce Output Operator [RS_67]
                                 key expressions:_col0 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                                 Group By Operator [GBY_66]
                                    keys:_col0 (type: string), _col1 (type: string)
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
                                    Select Operator [SEL_26]
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                                       Map Join Operator [MAPJOIN_166]
                                       |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |  keys:{"Map 1":"_col0 (type: string)","Reducer 8":"_col2 (type: string)"}
                                       |  outputColumnNames:["_col1","_col4"]
                                       |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                                       |<-Reducer 8 [BROADCAST_EDGE]
                                       |  Reduce Output Operator [RS_24]
                                       |     key expressions:_col2 (type: string)
                                       |     Map-reduce partition columns:_col2 (type: string)
                                       |     sort order:+
                                       |     Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                                       |     Map Join Operator [MAPJOIN_165]
                                       |     |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |     |  keys:{"Map 10":"_col1 (type: string)","Reducer 8":"_col1 (type: string)"}
                                       |     |  outputColumnNames:["_col2"]
                                       |     |  Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
                                       |     |<-Map 10 [BROADCAST_EDGE]
                                       |     |  Reduce Output Operator [RS_18]
                                       |     |     key expressions:_col1 (type: string)
                                       |     |     Map-reduce partition columns:_col1 (type: string)
                                       |     |     sort order:+
                                       |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                       |     |     value expressions:_col0 (type: string)
                                       |     |     Select Operator [SEL_14]
                                       |     |        outputColumnNames:["_col0","_col1"]
                                       |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                       |     |        Filter Operator [FIL_153]
                                       |     |           predicate:(value is not null and key is not null) (type: boolean)
                                       |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                       |     |           TableScan [TS_13]
                                       |     |              alias:x
                                       |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                       |     |<-Select Operator [SEL_12]
                                       |           outputColumnNames:["_col1"]
                                       |           Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                       |           Group By Operator [GBY_11]
                                       |           |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                       |           |  outputColumnNames:["_col0","_col1"]
                                       |           |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                       |           |<-Union 7 [SIMPLE_EDGE]
                                       |              |<-Map 6 [CONTAINS]
                                       |              |  Reduce Output Operator [RS_10]
                                       |              |     key expressions:_col0 (type: string), _col1 (type: string)
                                       |              |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                       |              |     sort order:++
                                       |              |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                       |              |     Group By Operator [GBY_9]
                                       |              |        keys:_col0 (type: string), _col1 (type: string)
                                       |              |        outputColumnNames:["_col0","_col1"]
                                       |              |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                       |              |        Select Operator [SEL_3]
                                       |              |           outputColumnNames:["_col0","_col1"]
                                       |              |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                       |              |           Filter Operator [FIL_151]
                                       |              |              predicate:value is not null (type: boolean)
                                       |              |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                       |              |              TableScan [TS_2]
                                       |              |                 alias:x
                                       |              |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                       |              |<-Map 9 [CONTAINS]
                                       |                 Reduce Output Operator [RS_10]
                                       |                    key expressions:_col0 (type: string), _col1 (type: string)
                                       |                    Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                       |                    sort order:++
                                       |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                       |                    Group By Operator [GBY_9]
                                       |                       keys:_col0 (type: string), _col1 (type: string)
                                       |                       outputColumnNames:["_col0","_col1"]
                                       |                       Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                       |                       Select Operator [SEL_5]
                                       |                          outputColumnNames:["_col0","_col1"]
                                       |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                       |                          Filter Operator [FIL_152]
                                       |                             predicate:value is not null (type: boolean)
                                       |                             Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                       |                             TableScan [TS_4]
                                       |                                alias:y
                                       |                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                       |<-Select Operator [SEL_1]
                                             outputColumnNames:["_col0","_col1"]
                                             Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                             Filter Operator [FIL_150]
                                                predicate:key is not null (type: boolean)
                                                Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                TableScan [TS_0]
                                                   alias:y
                                                   Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@srcbucket_mapjoin
POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@srcbucket_mapjoin
PREHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tab_part
POSTHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tab_part
PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@srcbucket_mapjoin_part
POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@srcbucket_mapjoin_part
PREHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin
POSTHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin
POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part
POSTHOOK: query: load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket21.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket21.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket22.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: load data local inpath '../../data/files/srcbucket23.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
PREHOOK: type: LOAD
#### A masked pattern was here ####
PREHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: query: load data local inpath '../../data/files/srcbucket23.txt' INTO TABLE srcbucket_mapjoin_part partition(ds='2008-04-08')
POSTHOOK: type: LOAD
#### A masked pattern was here ####
POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: query: insert overwrite table tab_part partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin_part
PREHOOK: type: QUERY
PREHOOK: Input: default@srcbucket_mapjoin_part
PREHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
PREHOOK: Output: default@tab_part@ds=2008-04-08
POSTHOOK: query: insert overwrite table tab_part partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin_part
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcbucket_mapjoin_part
POSTHOOK: Input: default@srcbucket_mapjoin_part@ds=2008-04-08
POSTHOOK: Output: default@tab_part@ds=2008-04-08
POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_part)srcbucket_mapjoin_part.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tab
POSTHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tab
PREHOOK: query: insert overwrite table tab partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
PREHOOK: type: QUERY
PREHOOK: Input: default@srcbucket_mapjoin
PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: Output: default@tab@ds=2008-04-08
POSTHOOK: query: insert overwrite table tab partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcbucket_mapjoin
POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
POSTHOOK: Output: default@tab@ds=2008-04-08
POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: tab PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: CREATE TABLE tab2(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@tab2
POSTHOOK: query: CREATE TABLE tab2(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@tab2
PREHOOK: query: insert overwrite table tab2 partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
PREHOOK: type: QUERY
PREHOOK: Input: default@srcbucket_mapjoin
PREHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
PREHOOK: Output: default@tab2@ds=2008-04-08
POSTHOOK: query: insert overwrite table tab2 partition (ds='2008-04-08')
select key,value from srcbucket_mapjoin
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcbucket_mapjoin
POSTHOOK: Input: default@srcbucket_mapjoin@ds=2008-04-08
POSTHOOK: Output: default@tab2@ds=2008-04-08
POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: tab2 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin)srcbucket_mapjoin.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Map 1
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_13]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"key (type: int)","0":"key (type: int)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            |  
            |<-Filter Operator [FIL_12]
            |     predicate:key is not null (type: boolean)
            |     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
            |     TableScan [TS_1]
            |        alias:s3
            |        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
            |<-Filter Operator [FIL_11]
                  predicate:key is not null (type: boolean)
                  Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                  TableScan [TS_0]
                     alias:s1
                     Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_14]
            compressed:false
            Statistics:Num rows: 146 Data size: 1552 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_25]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"value (type: string)","0":"_col1 (type: string)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 146 Data size: 1552 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_9]
            |     key expressions:_col1 (type: string)
            |     Map-reduce partition columns:_col1 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            |     value expressions:_col0 (type: int)
            |     Merge Join Operator [MERGEJOIN_23]
            |     |  condition map:[{"":"Inner Join 0 to 1"}]
            |     |  keys:{"1":"key (type: int)","0":"key (type: int)"}
            |     |  outputColumnNames:["_col0","_col1"]
            |     |  Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            |     |  
            |     |<-Filter Operator [FIL_21]
            |     |     predicate:key is not null (type: boolean)
            |     |     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
            |     |     TableScan [TS_1]
            |     |        alias:s3
            |     |        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
            |     |<-Filter Operator [FIL_20]
            |           predicate:(key is not null and value is not null) (type: boolean)
            |           Statistics:Num rows: 61 Data size: 646 Basic stats: COMPLETE Column stats: NONE
            |           TableScan [TS_0]
            |              alias:s1
            |              Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
            |<-Map 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_11]
                  key expressions:value (type: string)
                  Map-reduce partition columns:value (type: string)
                  sort order:+
                  Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator [FIL_22]
                     predicate:value is not null (type: boolean)
                     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_2]
                        alias:s2
                        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Map 1
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_13]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"key (type: int)","0":"key (type: int)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            |  
            |<-Filter Operator [FIL_12]
            |     predicate:key is not null (type: boolean)
            |     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
            |     TableScan [TS_1]
            |        alias:s3
            |        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
            |<-Filter Operator [FIL_11]
                  predicate:key is not null (type: boolean)
                  Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                  TableScan [TS_0]
                     alias:s1
                     Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key join tab2 s2 on s1.value=s2.value
PREHOOK: type: QUERY
POSTHOOK: query: explain 
select s1.key as key, s1.value as value from tab s1 join tab2 s3 on s1.key=s3.key join tab2 s2 on s1.value=s2.value
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_14]
            compressed:false
            Statistics:Num rows: 146 Data size: 1552 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Merge Join Operator [MERGEJOIN_25]
            |  condition map:[{"":"Inner Join 0 to 1"}]
            |  keys:{"1":"value (type: string)","0":"_col1 (type: string)"}
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 146 Data size: 1552 Basic stats: COMPLETE Column stats: NONE
            |<-Map 1 [SIMPLE_EDGE]
            |  Reduce Output Operator [RS_9]
            |     key expressions:_col1 (type: string)
            |     Map-reduce partition columns:_col1 (type: string)
            |     sort order:+
            |     Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            |     value expressions:_col0 (type: int)
            |     Merge Join Operator [MERGEJOIN_23]
            |     |  condition map:[{"":"Inner Join 0 to 1"}]
            |     |  keys:{"1":"key (type: int)","0":"key (type: int)"}
            |     |  outputColumnNames:["_col0","_col1"]
            |     |  Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
            |     |  
            |     |<-Filter Operator [FIL_21]
            |     |     predicate:key is not null (type: boolean)
            |     |     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
            |     |     TableScan [TS_1]
            |     |        alias:s3
            |     |        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
            |     |<-Filter Operator [FIL_20]
            |           predicate:(key is not null and value is not null) (type: boolean)
            |           Statistics:Num rows: 61 Data size: 646 Basic stats: COMPLETE Column stats: NONE
            |           TableScan [TS_0]
            |              alias:s1
            |              Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
            |<-Map 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_11]
                  key expressions:value (type: string)
                  Map-reduce partition columns:value (type: string)
                  sort order:+
                  Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator [FIL_22]
                     predicate:value is not null (type: boolean)
                     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_2]
                        alias:s2
                        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Vertex dependency in root stage
Reducer 3 <- Map 7 (SIMPLE_EDGE), Union 2 (SIMPLE_EDGE)
Map 1 <- Union 2 (CONTAINS)
Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
Map 6 <- Union 2 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 4
         File Output Operator [FS_22]
            compressed:false
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_20]
            |  aggregations:["count(VALUE._col0)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 3 [SIMPLE_EDGE]
               Reduce Output Operator [RS_19]
                  sort order:
                  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint)
                  Group By Operator [GBY_18]
                     aggregations:["count()"]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     Merge Join Operator [MERGEJOIN_35]
                     |  condition map:[{"":"Inner Join 0 to 1"}]
                     |  keys:{"1":"key (type: int)","0":"_col0 (type: int)"}
                     |  Statistics:Num rows: 279 Data size: 2963 Basic stats: COMPLETE Column stats: NONE
                     |<-Map 7 [SIMPLE_EDGE]
                     |  Reduce Output Operator [RS_15]
                     |     key expressions:key (type: int)
                     |     Map-reduce partition columns:key (type: int)
                     |     sort order:+
                     |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |     Filter Operator [FIL_32]
                     |        predicate:key is not null (type: boolean)
                     |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |        TableScan [TS_11]
                     |           alias:b
                     |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |<-Union 2 [SIMPLE_EDGE]
                        |<-Map 1 [CONTAINS]
                        |  Reduce Output Operator [RS_13]
                        |     key expressions:_col0 (type: int)
                        |     Map-reduce partition columns:_col0 (type: int)
                        |     sort order:+
                        |     Statistics:Num rows: 254 Data size: 2694 Basic stats: COMPLETE Column stats: NONE
                        |     Merge Join Operator [MERGEJOIN_33]
                        |     |  condition map:[{"":"Inner Join 0 to 1"}]
                        |     |  keys:{"1":"key (type: int)","0":"key (type: int)"}
                        |     |  outputColumnNames:["_col0"]
                        |     |  Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
                        |     |  
                        |     |<-Filter Operator [FIL_30]
                        |     |     predicate:key is not null (type: boolean)
                        |     |     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                        |     |     TableScan [TS_1]
                        |     |        alias:s3
                        |     |        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
                        |     |<-Filter Operator [FIL_29]
                        |           predicate:key is not null (type: boolean)
                        |           Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                        |           TableScan [TS_0]
                        |              alias:s1
                        |              Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 6 [CONTAINS]
                           Reduce Output Operator [RS_13]
                              key expressions:_col0 (type: int)
                              Map-reduce partition columns:_col0 (type: int)
                              sort order:+
                              Statistics:Num rows: 254 Data size: 2694 Basic stats: COMPLETE Column stats: NONE
                              Select Operator [SEL_9]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                                 Filter Operator [FIL_31]
                                    predicate:key is not null (type: boolean)
                                    Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                                    TableScan [TS_8]
                                       alias:s2
                                       Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
PREHOOK: type: QUERY
POSTHOOK: query: explain
select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
UNION  ALL
select s2.key as key, s2.value as value from tab s2
) a join tab_part b on (a.key = b.key)
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing statistics. Please check log for more details.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 7 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Map 9 (SIMPLE_EDGE), Union 3 (SIMPLE_EDGE)
Map 8 <- Union 3 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 5
         File Output Operator [FS_28]
            compressed:false
            Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_26]
            |  aggregations:["count(VALUE._col0)"]
            |  outputColumnNames:["_col0"]
            |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            |<-Reducer 4 [SIMPLE_EDGE]
               Reduce Output Operator [RS_25]
                  sort order:
                  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  value expressions:_col0 (type: bigint)
                  Group By Operator [GBY_24]
                     aggregations:["count()"]
                     outputColumnNames:["_col0"]
                     Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     Merge Join Operator [MERGEJOIN_47]
                     |  condition map:[{"":"Inner Join 0 to 1"}]
                     |  keys:{"1":"key (type: int)","0":"_col0 (type: int)"}
                     |  Statistics:Num rows: 293 Data size: 3118 Basic stats: COMPLETE Column stats: NONE
                     |<-Map 9 [SIMPLE_EDGE]
                     |  Reduce Output Operator [RS_21]
                     |     key expressions:key (type: int)
                     |     Map-reduce partition columns:key (type: int)
                     |     sort order:+
                     |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |     Filter Operator [FIL_43]
                     |        predicate:key is not null (type: boolean)
                     |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |        TableScan [TS_17]
                     |           alias:b
                     |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |<-Union 3 [SIMPLE_EDGE]
                        |<-Reducer 2 [CONTAINS]
                        |  Reduce Output Operator [RS_19]
                        |     key expressions:_col0 (type: int)
                        |     Map-reduce partition columns:_col0 (type: int)
                        |     sort order:+
                        |     Statistics:Num rows: 267 Data size: 2835 Basic stats: COMPLETE Column stats: NONE
                        |     Merge Join Operator [MERGEJOIN_46]
                        |     |  condition map:[{"":"Inner Join 0 to 1"}]
                        |     |  keys:{"1":"value (type: string)","0":"_col1 (type: string)"}
                        |     |  outputColumnNames:["_col0"]
                        |     |  Statistics:Num rows: 146 Data size: 1552 Basic stats: COMPLETE Column stats: NONE
                        |     |<-Map 1 [SIMPLE_EDGE]
                        |     |  Reduce Output Operator [RS_9]
                        |     |     key expressions:_col1 (type: string)
                        |     |     Map-reduce partition columns:_col1 (type: string)
                        |     |     sort order:+
                        |     |     Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
                        |     |     value expressions:_col0 (type: int)
                        |     |     Merge Join Operator [MERGEJOIN_44]
                        |     |     |  condition map:[{"":"Inner Join 0 to 1"}]
                        |     |     |  keys:{"1":"key (type: int)","0":"key (type: int)"}
                        |     |     |  outputColumnNames:["_col0","_col1"]
                        |     |     |  Statistics:Num rows: 133 Data size: 1411 Basic stats: COMPLETE Column stats: NONE
                        |     |     |  
                        |     |     |<-Filter Operator [FIL_40]
                        |     |     |     predicate:key is not null (type: boolean)
                        |     |     |     Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                        |     |     |     TableScan [TS_1]
                        |     |     |        alias:s3
                        |     |     |        Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
                        |     |     |<-Filter Operator [FIL_39]
                        |     |           predicate:(key is not null and value is not null) (type: boolean)
                        |     |           Statistics:Num rows: 61 Data size: 646 Basic stats: COMPLETE Column stats: NONE
                        |     |           TableScan [TS_0]
                        |     |              alias:s1
                        |     |              Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
                        |     |<-Map 7 [SIMPLE_EDGE]
                        |        Reduce Output Operator [RS_11]
                        |           key expressions:value (type: string)
                        |           Map-reduce partition columns:value (type: string)
                        |           sort order:+
                        |           Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                        |           Filter Operator [FIL_41]
                        |              predicate:value is not null (type: boolean)
                        |              Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                        |              TableScan [TS_2]
                        |                 alias:s2
                        |                 Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
                        |<-Map 8 [CONTAINS]
                           Reduce Output Operator [RS_19]
                              key expressions:_col0 (type: int)
                              Map-reduce partition columns:_col0 (type: int)
                              sort order:+
                              Statistics:Num rows: 267 Data size: 2835 Basic stats: COMPLETE Column stats: NONE
                              Select Operator [SEL_15]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                                 Filter Operator [FIL_42]
                                    predicate:key is not null (type: boolean)
                                    Statistics:Num rows: 121 Data size: 1283 Basic stats: COMPLETE Column stats: NONE
                                    TableScan [TS_14]
                                       alias:s2
                                       Statistics:Num rows: 242 Data size: 2566 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 12 <- Union 9 (CONTAINS)
Reducer 11 <- Map 15 (SIMPLE_EDGE), Reducer 10 (SIMPLE_EDGE), Union 3 (CONTAINS)
Map 13 <- Union 9 (CONTAINS)
Map 21 <- Map 20 (BROADCAST_EDGE)
Reducer 10 <- Map 14 (SIMPLE_EDGE), Union 9 (SIMPLE_EDGE)
Map 19 <- Map 21 (BROADCAST_EDGE), Union 3 (CONTAINS)
Map 16 <- Map 21 (BROADCAST_EDGE), Union 3 (CONTAINS)
Map 18 <- Map 21 (BROADCAST_EDGE), Union 3 (CONTAINS)
Map 17 <- Map 21 (BROADCAST_EDGE), Union 3 (CONTAINS)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS), Union 5 (SIMPLE_EDGE)
Map 4 <- Map 7 (BROADCAST_EDGE), Union 5 (CONTAINS)
Map 6 <- Map 7 (BROADCAST_EDGE), Union 5 (CONTAINS)
Map 8 <- Union 9 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Union 3
         |<-Reducer 11 [CONTAINS]
         |  File Output Operator [FS_77]
         |     compressed:false
         |     Statistics:Num rows: 1776 Data size: 18753 Basic stats: COMPLETE Column stats: NONE
         |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
         |     Select Operator [SEL_45]
         |        outputColumnNames:["_col0","_col1"]
         |        Statistics:Num rows: 620 Data size: 6547 Basic stats: COMPLETE Column stats: NONE
         |        Merge Join Operator [MERGEJOIN_120]
         |        |  condition map:[{"":"Inner Join 0 to 1"}]
         |        |  keys:{"1":"_col0 (type: string)","0":"_col1 (type: string)"}
         |        |  outputColumnNames:["_col1","_col4"]
         |        |  Statistics:Num rows: 620 Data size: 6547 Basic stats: COMPLETE Column stats: NONE
         |        |<-Map 15 [SIMPLE_EDGE]
         |        |  Reduce Output Operator [RS_43]
         |        |     key expressions:_col0 (type: string)
         |        |     Map-reduce partition columns:_col0 (type: string)
         |        |     sort order:+
         |        |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |        |     value expressions:_col1 (type: string)
         |        |     Select Operator [SEL_34]
         |        |        outputColumnNames:["_col0","_col1"]
         |        |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |        |        Filter Operator [FIL_110]
         |        |           predicate:key is not null (type: boolean)
         |        |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |        |           TableScan [TS_33]
         |        |              alias:y
         |        |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
         |        |<-Reducer 10 [SIMPLE_EDGE]
         |           Reduce Output Operator [RS_41]
         |              key expressions:_col1 (type: string)
         |              Map-reduce partition columns:_col1 (type: string)
         |              sort order:+
         |              Statistics:Num rows: 564 Data size: 5952 Basic stats: COMPLETE Column stats: NONE
         |              Merge Join Operator [MERGEJOIN_119]
         |              |  condition map:[{"":"Inner Join 0 to 1"}]
         |              |  keys:{"1":"_col1 (type: string)","0":"_col0 (type: string)"}
         |              |  outputColumnNames:["_col1"]
         |              |  Statistics:Num rows: 564 Data size: 5952 Basic stats: COMPLETE Column stats: NONE
         |              |<-Map 14 [SIMPLE_EDGE]
         |              |  Reduce Output Operator [RS_38]
         |              |     key expressions:_col1 (type: string)
         |              |     Map-reduce partition columns:_col1 (type: string)
         |              |     sort order:+
         |              |     Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
         |              |     value expressions:_col0 (type: string)
         |              |     Select Operator [SEL_32]
         |              |        outputColumnNames:["_col0","_col1"]
         |              |        Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
         |              |        Filter Operator [FIL_109]
         |              |           predicate:(value is not null and key is not null) (type: boolean)
         |              |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
         |              |           TableScan [TS_31]
         |              |              alias:y
         |              |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
         |              |<-Union 9 [SIMPLE_EDGE]
         |                 |<-Map 12 [CONTAINS]
         |                 |  Reduce Output Operator [RS_36]
         |                 |     key expressions:_col0 (type: string)
         |                 |     Map-reduce partition columns:_col0 (type: string)
         |                 |     sort order:+
         |                 |     Statistics:Num rows: 513 Data size: 5411 Basic stats: COMPLETE Column stats: NONE
         |                 |     Select Operator [SEL_25]
         |                 |        outputColumnNames:["_col0"]
         |                 |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |                 |        Filter Operator [FIL_107]
         |                 |           predicate:value is not null (type: boolean)
         |                 |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |                 |           TableScan [TS_24]
         |                 |              alias:y
         |                 |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
         |                 |<-Map 13 [CONTAINS]
         |                 |  Reduce Output Operator [RS_36]
         |                 |     key expressions:_col0 (type: string)
         |                 |     Map-reduce partition columns:_col0 (type: string)
         |                 |     sort order:+
         |                 |     Statistics:Num rows: 513 Data size: 5411 Basic stats: COMPLETE Column stats: NONE
         |                 |     Select Operator [SEL_29]
         |                 |        outputColumnNames:["_col0"]
         |                 |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |                 |        Filter Operator [FIL_108]
         |                 |           predicate:value is not null (type: boolean)
         |                 |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |                 |           TableScan [TS_28]
         |                 |              alias:y
         |                 |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
         |                 |<-Map 8 [CONTAINS]
         |                    Reduce Output Operator [RS_36]
         |                       key expressions:_col0 (type: string)
         |                       Map-reduce partition columns:_col0 (type: string)
         |                       sort order:+
         |                       Statistics:Num rows: 513 Data size: 5411 Basic stats: COMPLETE Column stats: NONE
         |                       Select Operator [SEL_23]
         |                          outputColumnNames:["_col0"]
         |                          Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
         |                          Filter Operator [FIL_106]
         |                             predicate:value is not null (type: boolean)
         |                             Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
         |                             TableScan [TS_22]
         |                                alias:x
         |                                Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
         |<-Map 19 [CONTAINS]
         |  File Output Operator [FS_77]
         |     compressed:false
         |     Statistics:Num rows: 1776 Data size: 18753 Basic stats: COMPLETE Column stats: NONE
         |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
         |     Select Operator [SEL_75]
         |        outputColumnNames:["_col0","_col1"]
         |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        Map Join Operator [MAPJOIN_122]
         |        |  condition map:[{"":"Inner Join 0 to 1"}]
         |        |  keys:{"Map 21":"_col1 (type: string)","Map 19":"_col0 (type: string)"}
         |        |  outputColumnNames:["_col1","_col4"]
         |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        |<-Map 21 [BROADCAST_EDGE]
         |        |  Reduce Output Operator [RS_73]
         |        |     key expressions:_col1 (type: string)
         |        |     Map-reduce partition columns:_col1 (type: string)
         |        |     sort order:+
         |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
         |        |     value expressions:_col0 (type: string), _col3 (type: string)
         |        |     Map Join Operator [MAPJOIN_121]
         |        |     |  condition map:[{"":"Inner Join 0 to 1"}]
         |        |     |  keys:{"Map 21":"_col0 (type: string)","Map 20":"_col0 (type: string)"}
         |        |     |  outputColumnNames:["_col0","_col1","_col3"]
         |        |     |  Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
         |        |     |<-Map 20 [BROADCAST_EDGE]
         |        |     |  Reduce Output Operator [RS_65]
         |        |     |     key expressions:_col0 (type: string)
         |        |     |     Map-reduce partition columns:_col0 (type: string)
         |        |     |     sort order:+
         |        |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
         |        |     |     value expressions:_col1 (type: string)
         |        |     |     Select Operator [SEL_61]
         |        |     |        outputColumnNames:["_col0","_col1"]
         |        |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
         |        |     |        Filter Operator [FIL_115]
         |        |     |           predicate:(key is not null and value is not null) (type: boolean)
         |        |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
         |        |     |           TableScan [TS_60]
         |        |     |              alias:x
         |        |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
         |        |     |<-Select Operator [SEL_63]
         |        |           outputColumnNames:["_col0","_col1"]
         |        |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
         |        |           Filter Operator [FIL_116]
         |        |              predicate:key is not null (type: boolean)
         |        |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
         |        |              TableScan [TS_62]
         |        |                 alias:x
         |        |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
         |        |  Reduce Output Operator [RS_126]
         |        |     key expressions:_col1 (type: string)
         |        |     Map-reduce partition columns:_col1 (type: string)
         |        |     sort order:+
         |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
         |        |     value expressions:_col0 (type: string), _col3 (type: string)
         |        |      Please refer to the previous Map Join Operator [MAPJOIN_121]
         |        |  Reduce Output Operator [RS_127]
         |        |     key expressions:_col1 (type: string)
         |        |     Map-reduce partition columns:_col1 (type: string)
         |        |     sort order:+
         |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
         |        |     value expressions:_col0 (type: string), _col3 (type: string)
         |        |      Please refer to the previous Map Join Operator [MAPJOIN_121]
         |        |  Reduce Output Operator [RS_128]
         |        |     key expressions:_col1 (type: string)
         |        |     Map-reduce partition columns:_col1 (type: string)
         |        |     sort order:+
         |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
         |        |     value expressions:_col0 (type: string), _col3 (type: string)
         |        |      Please refer to the previous Map Join Operator [MAPJOIN_121]
         |        |<-Select Operator [SEL_58]
         |              outputColumnNames:["_col0"]
         |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |              Filter Operator [FIL_114]
         |                 predicate:value is not null (type: boolean)
         |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |                 TableScan [TS_57]
         |                    alias:y
         |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
         |<-Map 16 [CONTAINS]
         |  File Output Operator [FS_77]
         |     compressed:false
         |     Statistics:Num rows: 1776 Data size: 18753 Basic stats: COMPLETE Column stats: NONE
         |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
         |     Select Operator [SEL_75]
         |        outputColumnNames:["_col0","_col1"]
         |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        Map Join Operator [MAPJOIN_122]
         |        |  condition map:[{"":"Inner Join 0 to 1"}]
         |        |  keys:{"Map 21":"_col1 (type: string)","Map 16":"_col0 (type: string)"}
         |        |  outputColumnNames:["_col1","_col4"]
         |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        |<- Please refer to the previous Map 21 [BROADCAST_EDGE]
         |        |<-Select Operator [SEL_49]
         |              outputColumnNames:["_col0"]
         |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
         |              Filter Operator [FIL_111]
         |                 predicate:value is not null (type: boolean)
         |                 Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
         |                 TableScan [TS_48]
         |                    alias:x
         |                    Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
         |<-Map 18 [CONTAINS]
         |  File Output Operator [FS_77]
         |     compressed:false
         |     Statistics:Num rows: 1776 Data size: 18753 Basic stats: COMPLETE Column stats: NONE
         |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
         |     Select Operator [SEL_75]
         |        outputColumnNames:["_col0","_col1"]
         |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        Map Join Operator [MAPJOIN_122]
         |        |  condition map:[{"":"Inner Join 0 to 1"}]
         |        |  keys:{"Map 21":"_col1 (type: string)","Map 18":"_col0 (type: string)"}
         |        |  outputColumnNames:["_col1","_col4"]
         |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        |<- Please refer to the previous Map 21 [BROADCAST_EDGE]
         |        |<-Select Operator [SEL_55]
         |              outputColumnNames:["_col0"]
         |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |              Filter Operator [FIL_113]
         |                 predicate:value is not null (type: boolean)
         |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |                 TableScan [TS_54]
         |                    alias:y
         |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
         |<-Map 17 [CONTAINS]
         |  File Output Operator [FS_77]
         |     compressed:false
         |     Statistics:Num rows: 1776 Data size: 18753 Basic stats: COMPLETE Column stats: NONE
         |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
         |     Select Operator [SEL_75]
         |        outputColumnNames:["_col0","_col1"]
         |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        Map Join Operator [MAPJOIN_122]
         |        |  condition map:[{"":"Inner Join 0 to 1"}]
         |        |  keys:{"Map 21":"_col1 (type: string)","Map 17":"_col0 (type: string)"}
         |        |  outputColumnNames:["_col1","_col4"]
         |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
         |        |<- Please refer to the previous Map 21 [BROADCAST_EDGE]
         |        |<-Select Operator [SEL_51]
         |              outputColumnNames:["_col0"]
         |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |              Filter Operator [FIL_112]
         |                 predicate:value is not null (type: boolean)
         |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
         |                 TableScan [TS_50]
         |                    alias:y
         |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
         |<-Reducer 2 [CONTAINS]
            File Output Operator [FS_77]
               compressed:false
               Statistics:Num rows: 1776 Data size: 18753 Basic stats: COMPLETE Column stats: NONE
               table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
               Select Operator [SEL_21]
                  outputColumnNames:["_col0","_col1"]
                  Statistics:Num rows: 317 Data size: 3333 Basic stats: COMPLETE Column stats: NONE
                  Merge Join Operator [MERGEJOIN_118]
                  |  condition map:[{"":"Inner Join 0 to 1"}]
                  |  keys:{"1":"_col1 (type: string)","0":"_col0 (type: string)"}
                  |  outputColumnNames:["_col1","_col3"]
                  |  Statistics:Num rows: 317 Data size: 3333 Basic stats: COMPLETE Column stats: NONE
                  |<-Map 1 [SIMPLE_EDGE]
                  |  Reduce Output Operator [RS_17]
                  |     key expressions:_col0 (type: string)
                  |     Map-reduce partition columns:_col0 (type: string)
                  |     sort order:+
                  |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                  |     value expressions:_col1 (type: string)
                  |     Select Operator [SEL_1]
                  |        outputColumnNames:["_col0","_col1"]
                  |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                  |        Filter Operator [FIL_102]
                  |           predicate:key is not null (type: boolean)
                  |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                  |           TableScan [TS_0]
                  |              alias:y
                  |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                  |<-Union 5 [SIMPLE_EDGE]
                     |<-Map 4 [CONTAINS]
                     |  Reduce Output Operator [RS_19]
                     |     key expressions:_col1 (type: string)
                     |     Map-reduce partition columns:_col1 (type: string)
                     |     sort order:+
                     |     Statistics:Num rows: 289 Data size: 3030 Basic stats: COMPLETE Column stats: NONE
                     |     Map Join Operator [MAPJOIN_117]
                     |     |  condition map:[{"":"Inner Join 0 to 1"}]
                     |     |  keys:{"Map 4":"_col0 (type: string)","Map 7":"_col1 (type: string)"}
                     |     |  outputColumnNames:["_col1"]
                     |     |  Statistics:Num rows: 289 Data size: 3030 Basic stats: COMPLETE Column stats: NONE
                     |     |<-Map 7 [BROADCAST_EDGE]
                     |     |  Reduce Output Operator [RS_13]
                     |     |     key expressions:_col1 (type: string)
                     |     |     Map-reduce partition columns:_col1 (type: string)
                     |     |     sort order:+
                     |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                     |     |     value expressions:_col0 (type: string)
                     |     |     Select Operator [SEL_9]
                     |     |        outputColumnNames:["_col0","_col1"]
                     |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                     |     |        Filter Operator [FIL_105]
                     |     |           predicate:(value is not null and key is not null) (type: boolean)
                     |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                     |     |           TableScan [TS_8]
                     |     |              alias:x
                     |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                     |     |  Reduce Output Operator [RS_123]
                     |     |     key expressions:_col1 (type: string)
                     |     |     Map-reduce partition columns:_col1 (type: string)
                     |     |     sort order:+
                     |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                     |     |     value expressions:_col0 (type: string)
                     |     |      Please refer to the previous Select Operator [SEL_9]
                     |     |<-Select Operator [SEL_3]
                     |           outputColumnNames:["_col0"]
                     |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                     |           Filter Operator [FIL_103]
                     |              predicate:value is not null (type: boolean)
                     |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                     |              TableScan [TS_2]
                     |                 alias:x
                     |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                     |<-Map 6 [CONTAINS]
                        Reduce Output Operator [RS_19]
                           key expressions:_col1 (type: string)
                           Map-reduce partition columns:_col1 (type: string)
                           sort order:+
                           Statistics:Num rows: 289 Data size: 3030 Basic stats: COMPLETE Column stats: NONE
                           Map Join Operator [MAPJOIN_117]
                           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |  keys:{"Map 7":"_col1 (type: string)","Map 6":"_col0 (type: string)"}
                           |  outputColumnNames:["_col1"]
                           |  Statistics:Num rows: 289 Data size: 3030 Basic stats: COMPLETE Column stats: NONE
                           |<- Please refer to the previous Map 7 [BROADCAST_EDGE]
                           |<-Select Operator [SEL_5]
                                 outputColumnNames:["_col0"]
                                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                 Filter Operator [FIL_104]
                                    predicate:value is not null (type: boolean)
                                    Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                    TableScan [TS_4]
                                       alias:y
                                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
POSTHOOK: type: QUERY
Plan optimized by CBO.

Vertex dependency in root stage
Map 12 <- Union 13 (CONTAINS)
Map 30 <- Union 24 (CONTAINS)
Reducer 14 <- Union 13 (SIMPLE_EDGE), Union 15 (CONTAINS)
Map 23 <- Union 24 (CONTAINS)
Map 32 <- Union 28 (CONTAINS)
Reducer 25 <- Union 24 (SIMPLE_EDGE), Union 26 (CONTAINS)
Map 31 <- Union 26 (CONTAINS)
Map 34 <- Map 33 (BROADCAST_EDGE)
Map 20 <- Union 15 (CONTAINS)
Map 10 <- Union 8 (CONTAINS)
Reducer 4 <- Union 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
Map 19 <- Union 13 (CONTAINS)
Reducer 6 <- Union 5 (SIMPLE_EDGE)
Reducer 9 <- Map 11 (BROADCAST_EDGE), Union 8 (SIMPLE_EDGE)
Reducer 17 <- Map 21 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE)
Reducer 27 <- Union 26 (SIMPLE_EDGE), Union 28 (CONTAINS)
Reducer 18 <- Map 22 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 29 <- Map 34 (BROADCAST_EDGE), Union 28 (SIMPLE_EDGE), Union 5 (CONTAINS)
Reducer 16 <- Union 15 (SIMPLE_EDGE)
Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE), Union 3 (CONTAINS)
Map 7 <- Union 8 (CONTAINS)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 6
         File Output Operator [FS_121]
            compressed:false
            Statistics:Num rows: 258 Data size: 2737 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Group By Operator [GBY_119]
            |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
            |  outputColumnNames:["_col0","_col1"]
            |  Statistics:Num rows: 258 Data size: 2737 Basic stats: COMPLETE Column stats: NONE
            |<-Union 5 [SIMPLE_EDGE]
               |<-Reducer 4 [CONTAINS]
               |  Reduce Output Operator [RS_118]
               |     key expressions:_col0 (type: string), _col1 (type: string)
               |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |     sort order:++
               |     Statistics:Num rows: 517 Data size: 5486 Basic stats: COMPLETE Column stats: NONE
               |     Group By Operator [GBY_117]
               |        keys:_col0 (type: string), _col1 (type: string)
               |        outputColumnNames:["_col0","_col1"]
               |        Statistics:Num rows: 517 Data size: 5486 Basic stats: COMPLETE Column stats: NONE
               |        Group By Operator [GBY_67]
               |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |        |  outputColumnNames:["_col0","_col1"]
               |        |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |        |<-Union 3 [SIMPLE_EDGE]
               |           |<-Reducer 18 [CONTAINS]
               |           |  Reduce Output Operator [RS_66]
               |           |     key expressions:_col0 (type: string), _col1 (type: string)
               |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |     sort order:++
               |           |     Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |           |     Group By Operator [GBY_65]
               |           |        keys:_col0 (type: string), _col1 (type: string)
               |           |        outputColumnNames:["_col0","_col1"]
               |           |        Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |           |        Select Operator [SEL_61]
               |           |           outputColumnNames:["_col0","_col1"]
               |           |           Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           |           Merge Join Operator [MERGEJOIN_164]
               |           |           |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |           |  keys:{"1":"_col0 (type: string)","0":"_col2 (type: string)"}
               |           |           |  outputColumnNames:["_col2","_col5"]
               |           |           |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |           |           |<-Map 22 [SIMPLE_EDGE]
               |           |           |  Reduce Output Operator [RS_59]
               |           |           |     key expressions:_col0 (type: string)
               |           |           |     Map-reduce partition columns:_col0 (type: string)
               |           |           |     sort order:+
               |           |           |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |           |     value expressions:_col1 (type: string)
               |           |           |     Select Operator [SEL_50]
               |           |           |        outputColumnNames:["_col0","_col1"]
               |           |           |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |           |        Filter Operator [FIL_154]
               |           |           |           predicate:key is not null (type: boolean)
               |           |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |           |           TableScan [TS_49]
               |           |           |              alias:y
               |           |           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |           |<-Reducer 17 [SIMPLE_EDGE]
               |           |              Reduce Output Operator [RS_57]
               |           |                 key expressions:_col2 (type: string)
               |           |                 Map-reduce partition columns:_col2 (type: string)
               |           |                 sort order:+
               |           |                 Statistics:Num rows: 209 Data size: 2208 Basic stats: COMPLETE Column stats: NONE
               |           |                 Merge Join Operator [MERGEJOIN_163]
               |           |                 |  condition map:[{"":"Inner Join 0 to 1"}]
               |           |                 |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
               |           |                 |  outputColumnNames:["_col2"]
               |           |                 |  Statistics:Num rows: 209 Data size: 2208 Basic stats: COMPLETE Column stats: NONE
               |           |                 |<-Map 21 [SIMPLE_EDGE]
               |           |                 |  Reduce Output Operator [RS_54]
               |           |                 |     key expressions:_col1 (type: string)
               |           |                 |     Map-reduce partition columns:_col1 (type: string)
               |           |                 |     sort order:+
               |           |                 |     Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
               |           |                 |     value expressions:_col0 (type: string)
               |           |                 |     Select Operator [SEL_48]
               |           |                 |        outputColumnNames:["_col0","_col1"]
               |           |                 |        Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
               |           |                 |        Filter Operator [FIL_153]
               |           |                 |           predicate:(value is not null and key is not null) (type: boolean)
               |           |                 |           Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
               |           |                 |           TableScan [TS_47]
               |           |                 |              alias:y
               |           |                 |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |                 |<-Reducer 16 [SIMPLE_EDGE]
               |           |                    Reduce Output Operator [RS_52]
               |           |                       key expressions:_col1 (type: string)
               |           |                       Map-reduce partition columns:_col1 (type: string)
               |           |                       sort order:+
               |           |                       Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
               |           |                       Select Operator [SEL_46]
               |           |                          outputColumnNames:["_col1"]
               |           |                          Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
               |           |                          Group By Operator [GBY_45]
               |           |                          |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |           |                          |  outputColumnNames:["_col0","_col1"]
               |           |                          |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
               |           |                          |<-Union 15 [SIMPLE_EDGE]
               |           |                             |<-Reducer 14 [CONTAINS]
               |           |                             |  Reduce Output Operator [RS_44]
               |           |                             |     key expressions:_col0 (type: string), _col1 (type: string)
               |           |                             |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                             |     sort order:++
               |           |                             |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                             |     Group By Operator [GBY_43]
               |           |                             |        keys:_col0 (type: string), _col1 (type: string)
               |           |                             |        outputColumnNames:["_col0","_col1"]
               |           |                             |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                             |        Group By Operator [GBY_36]
               |           |                             |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |           |                             |        |  outputColumnNames:["_col0","_col1"]
               |           |                             |        |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |           |                             |        |<-Union 13 [SIMPLE_EDGE]
               |           |                             |           |<-Map 12 [CONTAINS]
               |           |                             |           |  Reduce Output Operator [RS_35]
               |           |                             |           |     key expressions:_col0 (type: string), _col1 (type: string)
               |           |                             |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                             |           |     sort order:++
               |           |                             |           |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                             |           |     Group By Operator [GBY_34]
               |           |                             |           |        keys:_col0 (type: string), _col1 (type: string)
               |           |                             |           |        outputColumnNames:["_col0","_col1"]
               |           |                             |           |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                             |           |        Select Operator [SEL_28]
               |           |                             |           |           outputColumnNames:["_col0","_col1"]
               |           |                             |           |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |           |                             |           |           Filter Operator [FIL_150]
               |           |                             |           |              predicate:value is not null (type: boolean)
               |           |                             |           |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |           |                             |           |              TableScan [TS_27]
               |           |                             |           |                 alias:x
               |           |                             |           |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |           |                             |           |<-Map 19 [CONTAINS]
               |           |                             |              Reduce Output Operator [RS_35]
               |           |                             |                 key expressions:_col0 (type: string), _col1 (type: string)
               |           |                             |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                             |                 sort order:++
               |           |                             |                 Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                             |                 Group By Operator [GBY_34]
               |           |                             |                    keys:_col0 (type: string), _col1 (type: string)
               |           |                             |                    outputColumnNames:["_col0","_col1"]
               |           |                             |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |           |                             |                    Select Operator [SEL_30]
               |           |                             |                       outputColumnNames:["_col0","_col1"]
               |           |                             |                       Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                             |                       Filter Operator [FIL_151]
               |           |                             |                          predicate:value is not null (type: boolean)
               |           |                             |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                             |                          TableScan [TS_29]
               |           |                             |                             alias:y
               |           |                             |                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |                             |<-Map 20 [CONTAINS]
               |           |                                Reduce Output Operator [RS_44]
               |           |                                   key expressions:_col0 (type: string), _col1 (type: string)
               |           |                                   Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |           |                                   sort order:++
               |           |                                   Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                                   Group By Operator [GBY_43]
               |           |                                      keys:_col0 (type: string), _col1 (type: string)
               |           |                                      outputColumnNames:["_col0","_col1"]
               |           |                                      Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
               |           |                                      Select Operator [SEL_39]
               |           |                                         outputColumnNames:["_col0","_col1"]
               |           |                                         Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                                         Filter Operator [FIL_152]
               |           |                                            predicate:value is not null (type: boolean)
               |           |                                            Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |           |                                            TableScan [TS_38]
               |           |                                               alias:y
               |           |                                               Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |           |<-Reducer 2 [CONTAINS]
               |              Reduce Output Operator [RS_66]
               |                 key expressions:_col0 (type: string), _col1 (type: string)
               |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                 sort order:++
               |                 Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |                 Group By Operator [GBY_65]
               |                    keys:_col0 (type: string), _col1 (type: string)
               |                    outputColumnNames:["_col0","_col1"]
               |                    Statistics:Num rows: 550 Data size: 5842 Basic stats: COMPLETE Column stats: NONE
               |                    Select Operator [SEL_26]
               |                       outputColumnNames:["_col0","_col1"]
               |                       Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |                       Merge Join Operator [MERGEJOIN_162]
               |                       |  condition map:[{"":"Inner Join 0 to 1"}]
               |                       |  keys:{"1":"_col2 (type: string)","0":"_col0 (type: string)"}
               |                       |  outputColumnNames:["_col1","_col4"]
               |                       |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |                       |<-Map 1 [SIMPLE_EDGE]
               |                       |  Reduce Output Operator [RS_22]
               |                       |     key expressions:_col0 (type: string)
               |                       |     Map-reduce partition columns:_col0 (type: string)
               |                       |     sort order:+
               |                       |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                       |     value expressions:_col1 (type: string)
               |                       |     Select Operator [SEL_1]
               |                       |        outputColumnNames:["_col0","_col1"]
               |                       |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                       |        Filter Operator [FIL_146]
               |                       |           predicate:key is not null (type: boolean)
               |                       |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                       |           TableScan [TS_0]
               |                       |              alias:y
               |                       |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |                       |<-Reducer 9 [SIMPLE_EDGE]
               |                          Reduce Output Operator [RS_24]
               |                             key expressions:_col2 (type: string)
               |                             Map-reduce partition columns:_col2 (type: string)
               |                             sort order:+
               |                             Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
               |                             Map Join Operator [MAPJOIN_161]
               |                             |  condition map:[{"":"Inner Join 0 to 1"}]
               |                             |  keys:{"Map 11":"_col1 (type: string)","Reducer 9":"_col1 (type: string)"}
               |                             |  outputColumnNames:["_col2"]
               |                             |  Statistics:Num rows: 144 Data size: 1509 Basic stats: COMPLETE Column stats: NONE
               |                             |<-Map 11 [BROADCAST_EDGE]
               |                             |  Reduce Output Operator [RS_18]
               |                             |     key expressions:_col1 (type: string)
               |                             |     Map-reduce partition columns:_col1 (type: string)
               |                             |     sort order:+
               |                             |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                             |     value expressions:_col0 (type: string)
               |                             |     Select Operator [SEL_14]
               |                             |        outputColumnNames:["_col0","_col1"]
               |                             |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                             |        Filter Operator [FIL_149]
               |                             |           predicate:(value is not null and key is not null) (type: boolean)
               |                             |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
               |                             |           TableScan [TS_13]
               |                             |              alias:x
               |                             |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |                             |<-Select Operator [SEL_12]
               |                                   outputColumnNames:["_col1"]
               |                                   Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |                                   Group By Operator [GBY_11]
               |                                   |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
               |                                   |  outputColumnNames:["_col0","_col1"]
               |                                   |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
               |                                   |<-Union 8 [SIMPLE_EDGE]
               |                                      |<-Map 10 [CONTAINS]
               |                                      |  Reduce Output Operator [RS_10]
               |                                      |     key expressions:_col0 (type: string), _col1 (type: string)
               |                                      |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                                      |     sort order:++
               |                                      |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                                      |     Group By Operator [GBY_9]
               |                                      |        keys:_col0 (type: string), _col1 (type: string)
               |                                      |        outputColumnNames:["_col0","_col1"]
               |                                      |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                                      |        Select Operator [SEL_5]
               |                                      |           outputColumnNames:["_col0","_col1"]
               |                                      |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                                      |           Filter Operator [FIL_148]
               |                                      |              predicate:value is not null (type: boolean)
               |                                      |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |                                      |              TableScan [TS_4]
               |                                      |                 alias:y
               |                                      |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |                                      |<-Map 7 [CONTAINS]
               |                                         Reduce Output Operator [RS_10]
               |                                            key expressions:_col0 (type: string), _col1 (type: string)
               |                                            Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
               |                                            sort order:++
               |                                            Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                                            Group By Operator [GBY_9]
               |                                               keys:_col0 (type: string), _col1 (type: string)
               |                                               outputColumnNames:["_col0","_col1"]
               |                                               Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
               |                                               Select Operator [SEL_3]
               |                                                  outputColumnNames:["_col0","_col1"]
               |                                                  Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |                                                  Filter Operator [FIL_147]
               |                                                     predicate:value is not null (type: boolean)
               |                                                     Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
               |                                                     TableScan [TS_2]
               |                                                        alias:x
               |                                                        Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |<-Reducer 29 [CONTAINS]
                  Reduce Output Operator [RS_118]
                     key expressions:_col0 (type: string), _col1 (type: string)
                     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                     sort order:++
                     Statistics:Num rows: 517 Data size: 5486 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator [GBY_117]
                        keys:_col0 (type: string), _col1 (type: string)
                        outputColumnNames:["_col0","_col1"]
                        Statistics:Num rows: 517 Data size: 5486 Basic stats: COMPLETE Column stats: NONE
                        Select Operator [SEL_113]
                           outputColumnNames:["_col0","_col1"]
                           Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
                           Map Join Operator [MAPJOIN_166]
                           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |  keys:{"Map 34":"_col1 (type: string)","Reducer 29":"_col1 (type: string)"}
                           |  outputColumnNames:["_col2","_col5"]
                           |  Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
                           |<-Map 34 [BROADCAST_EDGE]
                           |  Reduce Output Operator [RS_111]
                           |     key expressions:_col1 (type: string)
                           |     Map-reduce partition columns:_col1 (type: string)
                           |     sort order:+
                           |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                           |     value expressions:_col0 (type: string), _col3 (type: string)
                           |     Map Join Operator [MAPJOIN_165]
                           |     |  condition map:[{"":"Inner Join 0 to 1"}]
                           |     |  keys:{"Map 34":"_col0 (type: string)","Map 33":"_col0 (type: string)"}
                           |     |  outputColumnNames:["_col0","_col1","_col3"]
                           |     |  Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                           |     |<-Map 33 [BROADCAST_EDGE]
                           |     |  Reduce Output Operator [RS_103]
                           |     |     key expressions:_col0 (type: string)
                           |     |     Map-reduce partition columns:_col0 (type: string)
                           |     |     sort order:+
                           |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |     |     value expressions:_col1 (type: string)
                           |     |     Select Operator [SEL_99]
                           |     |        outputColumnNames:["_col0","_col1"]
                           |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |     |        Filter Operator [FIL_159]
                           |     |           predicate:(key is not null and value is not null) (type: boolean)
                           |     |           Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |     |           TableScan [TS_98]
                           |     |              alias:x
                           |     |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |     |<-Select Operator [SEL_101]
                           |           outputColumnNames:["_col0","_col1"]
                           |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |           Filter Operator [FIL_160]
                           |              predicate:key is not null (type: boolean)
                           |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |              TableScan [TS_100]
                           |                 alias:x
                           |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |<-Select Operator [SEL_97]
                                 outputColumnNames:["_col1"]
                                 Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
                                 Group By Operator [GBY_96]
                                 |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                 |  outputColumnNames:["_col0","_col1"]
                                 |  Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
                                 |<-Union 28 [SIMPLE_EDGE]
                                    |<-Map 32 [CONTAINS]
                                    |  Reduce Output Operator [RS_95]
                                    |     key expressions:_col0 (type: string), _col1 (type: string)
                                    |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                    |     sort order:++
                                    |     Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                    |     Group By Operator [GBY_94]
                                    |        keys:_col0 (type: string), _col1 (type: string)
                                    |        outputColumnNames:["_col0","_col1"]
                                    |        Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                    |        Select Operator [SEL_90]
                                    |           outputColumnNames:["_col0","_col1"]
                                    |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                    |           Filter Operator [FIL_158]
                                    |              predicate:value is not null (type: boolean)
                                    |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                    |              TableScan [TS_89]
                                    |                 alias:y
                                    |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                    |<-Reducer 27 [CONTAINS]
                                       Reduce Output Operator [RS_95]
                                          key expressions:_col0 (type: string), _col1 (type: string)
                                          Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                          sort order:++
                                          Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                          Group By Operator [GBY_94]
                                             keys:_col0 (type: string), _col1 (type: string)
                                             outputColumnNames:["_col0","_col1"]
                                             Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                             Group By Operator [GBY_87]
                                             |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                             |  outputColumnNames:["_col0","_col1"]
                                             |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                                             |<-Union 26 [SIMPLE_EDGE]
                                                |<-Reducer 25 [CONTAINS]
                                                |  Reduce Output Operator [RS_86]
                                                |     key expressions:_col0 (type: string), _col1 (type: string)
                                                |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                |     sort order:++
                                                |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                |     Group By Operator [GBY_85]
                                                |        keys:_col0 (type: string), _col1 (type: string)
                                                |        outputColumnNames:["_col0","_col1"]
                                                |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                |        Group By Operator [GBY_78]
                                                |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                                |        |  outputColumnNames:["_col0","_col1"]
                                                |        |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                                |        |<-Union 24 [SIMPLE_EDGE]
                                                |           |<-Map 30 [CONTAINS]
                                                |           |  Reduce Output Operator [RS_77]
                                                |           |     key expressions:_col0 (type: string), _col1 (type: string)
                                                |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                |           |     sort order:++
                                                |           |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                |           |     Group By Operator [GBY_76]
                                                |           |        keys:_col0 (type: string), _col1 (type: string)
                                                |           |        outputColumnNames:["_col0","_col1"]
                                                |           |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                |           |        Select Operator [SEL_72]
                                                |           |           outputColumnNames:["_col0","_col1"]
                                                |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                |           |           Filter Operator [FIL_156]
                                                |           |              predicate:value is not null (type: boolean)
                                                |           |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                |           |              TableScan [TS_71]
                                                |           |                 alias:y
                                                |           |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                |           |<-Map 23 [CONTAINS]
                                                |              Reduce Output Operator [RS_77]
                                                |                 key expressions:_col0 (type: string), _col1 (type: string)
                                                |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                |                 sort order:++
                                                |                 Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                |                 Group By Operator [GBY_76]
                                                |                    keys:_col0 (type: string), _col1 (type: string)
                                                |                    outputColumnNames:["_col0","_col1"]
                                                |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                |                    Select Operator [SEL_70]
                                                |                       outputColumnNames:["_col0","_col1"]
                                                |                       Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                                |                       Filter Operator [FIL_155]
                                                |                          predicate:value is not null (type: boolean)
                                                |                          Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                                |                          TableScan [TS_69]
                                                |                             alias:x
                                                |                             Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                                |<-Map 31 [CONTAINS]
                                                   Reduce Output Operator [RS_86]
                                                      key expressions:_col0 (type: string), _col1 (type: string)
                                                      Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                      sort order:++
                                                      Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                      Group By Operator [GBY_85]
                                                         keys:_col0 (type: string), _col1 (type: string)
                                                         outputColumnNames:["_col0","_col1"]
                                                         Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                         Select Operator [SEL_81]
                                                            outputColumnNames:["_col0","_col1"]
                                                            Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                            Filter Operator [FIL_157]
                                                               predicate:value is not null (type: boolean)
                                                               Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                               TableScan [TS_80]
                                                                  alias:y
                                                                  Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: CREATE TABLE a(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@a
POSTHOOK: query: CREATE TABLE a(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@a
PREHOOK: query: CREATE TABLE b(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@b
POSTHOOK: query: CREATE TABLE b(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@b
PREHOOK: query: CREATE TABLE c(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@c
POSTHOOK: query: CREATE TABLE c(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@c
PREHOOK: query: explain
from
(
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
from
(
SELECT x.key, y.value
FROM src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union all select * from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
union all
SELECT x.key, y.value
FROM src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union all select key, value from src union all select key, value from src union all select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Map 12 <- Union 9 (CONTAINS)
Reducer 14 <- Map 13 (SIMPLE_EDGE), Map 15 (SIMPLE_EDGE)
Map 11 <- Union 9 (CONTAINS)
Map 21 <- Map 20 (BROADCAST_EDGE)
Map 1 <- Union 2 (CONTAINS)
Reducer 10 <- Reducer 14 (SIMPLE_EDGE), Union 4 (CONTAINS), Union 9 (SIMPLE_EDGE)
Map 19 <- Map 21 (BROADCAST_EDGE), Union 4 (CONTAINS)
Map 16 <- Map 21 (BROADCAST_EDGE), Union 4 (CONTAINS)
Map 18 <- Map 21 (BROADCAST_EDGE), Union 4 (CONTAINS)
Map 17 <- Map 21 (BROADCAST_EDGE), Union 4 (CONTAINS)
Reducer 3 <- Map 7 (SIMPLE_EDGE), Union 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
Map 5 <- Union 2 (CONTAINS)
Map 7 <- Map 6 (BROADCAST_EDGE)
Map 8 <- Union 9 (CONTAINS)

Stage-15
   Stats-Aggr Operator
      Stage-1
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Stage-4
               Dependency Collection{}
                  Stage-3
                     Union 4
                     |<-Reducer 10 [CONTAINS]
                     |  File Output Operator [FS_62]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |     Select Operator [SEL_37]
                     |        outputColumnNames:["_col0","_col1"]
                     |        Statistics:Num rows: 564 Data size: 5952 Basic stats: COMPLETE Column stats: NONE
                     |        Merge Join Operator [MERGEJOIN_107]
                     |        |  condition map:[{"":"Inner Join 0 to 1"}]
                     |        |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                     |        |  outputColumnNames:["_col0","_col6"]
                     |        |  Statistics:Num rows: 564 Data size: 5952 Basic stats: COMPLETE Column stats: NONE
                     |        |<-Reducer 14 [SIMPLE_EDGE]
                     |        |  Reduce Output Operator [RS_33]
                     |        |     key expressions:_col1 (type: string)
                     |        |     Map-reduce partition columns:_col1 (type: string)
                     |        |     sort order:+
                     |        |     Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                     |        |     value expressions:_col0 (type: string), _col6 (type: string)
                     |        |     Merge Join Operator [MERGEJOIN_104]
                     |        |     |  condition map:[{"":"Inner Join 0 to 1"}]
                     |        |     |  keys:{"1":"key (type: string)","0":"key (type: string)"}
                     |        |     |  outputColumnNames:["_col0","_col1","_col6"]
                     |        |     |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                     |        |     |<-Map 13 [SIMPLE_EDGE]
                     |        |     |  Reduce Output Operator [RS_28]
                     |        |     |     key expressions:key (type: string)
                     |        |     |     Map-reduce partition columns:key (type: string)
                     |        |     |     sort order:+
                     |        |     |     Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                     |        |     |     value expressions:value (type: string)
                     |        |     |     Filter Operator [FIL_95]
                     |        |     |        predicate:(key is not null and value is not null) (type: boolean)
                     |        |     |        Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                     |        |     |        TableScan [TS_25]
                     |        |     |           alias:x
                     |        |     |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |        |     |<-Map 15 [SIMPLE_EDGE]
                     |        |        Reduce Output Operator [RS_30]
                     |        |           key expressions:key (type: string)
                     |        |           Map-reduce partition columns:key (type: string)
                     |        |           sort order:+
                     |        |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |        |           value expressions:value (type: string)
                     |        |           Filter Operator [FIL_96]
                     |        |              predicate:key is not null (type: boolean)
                     |        |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |        |              TableScan [TS_26]
                     |        |                 alias:y
                     |        |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |        |<-Union 9 [SIMPLE_EDGE]
                     |           |<-Map 12 [CONTAINS]
                     |           |  Reduce Output Operator [RS_35]
                     |           |     key expressions:_col1 (type: string)
                     |           |     Map-reduce partition columns:_col1 (type: string)
                     |           |     sort order:+
                     |           |     Statistics:Num rows: 513 Data size: 5411 Basic stats: COMPLETE Column stats: NONE
                     |           |     Select Operator [SEL_24]
                     |           |        outputColumnNames:["_col1"]
                     |           |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |           |        Filter Operator [FIL_94]
                     |           |           predicate:value is not null (type: boolean)
                     |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |           |           TableScan [TS_23]
                     |           |              alias:src
                     |           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |           |<-Map 11 [CONTAINS]
                     |           |  Reduce Output Operator [RS_35]
                     |           |     key expressions:_col1 (type: string)
                     |           |     Map-reduce partition columns:_col1 (type: string)
                     |           |     sort order:+
                     |           |     Statistics:Num rows: 513 Data size: 5411 Basic stats: COMPLETE Column stats: NONE
                     |           |     Select Operator [SEL_21]
                     |           |        outputColumnNames:["_col1"]
                     |           |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |           |        Filter Operator [FIL_93]
                     |           |           predicate:value is not null (type: boolean)
                     |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |           |           TableScan [TS_20]
                     |           |              alias:src
                     |           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |           |<-Map 8 [CONTAINS]
                     |              Reduce Output Operator [RS_35]
                     |                 key expressions:_col1 (type: string)
                     |                 Map-reduce partition columns:_col1 (type: string)
                     |                 sort order:+
                     |                 Statistics:Num rows: 513 Data size: 5411 Basic stats: COMPLETE Column stats: NONE
                     |                 Select Operator [SEL_19]
                     |                    outputColumnNames:["_col1"]
                     |                    Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                     |                    Filter Operator [FIL_92]
                     |                       predicate:value is not null (type: boolean)
                     |                       Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                     |                       TableScan [TS_18]
                     |                          alias:src1
                     |                          Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                     |  File Output Operator [FS_64]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_37]
                     |  File Output Operator [FS_66]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_37]
                     |<-Map 19 [CONTAINS]
                     |  File Output Operator [FS_62]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |     Select Operator [SEL_60]
                     |        outputColumnNames:["_col0","_col1"]
                     |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        Map Join Operator [MAPJOIN_108]
                     |        |  condition map:[{"":"Inner Join 0 to 1"}]
                     |        |  keys:{"Map 21":"_col1 (type: string)","Map 19":"_col1 (type: string)"}
                     |        |  outputColumnNames:["_col0","_col6"]
                     |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        |<-Map 21 [BROADCAST_EDGE]
                     |        |  Reduce Output Operator [RS_56]
                     |        |     key expressions:_col1 (type: string)
                     |        |     Map-reduce partition columns:_col1 (type: string)
                     |        |     sort order:+
                     |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                     |        |     value expressions:_col0 (type: string), _col6 (type: string)
                     |        |     Map Join Operator [MAPJOIN_105]
                     |        |     |  condition map:[{"":"Inner Join 0 to 1"}]
                     |        |     |  keys:{"Map 21":"key (type: string)","Map 20":"key (type: string)"}
                     |        |     |  outputColumnNames:["_col0","_col1","_col6"]
                     |        |     |  Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                     |        |     |<-Map 20 [BROADCAST_EDGE]
                     |        |     |  Reduce Output Operator [RS_51]
                     |        |     |     key expressions:key (type: string)
                     |        |     |     Map-reduce partition columns:key (type: string)
                     |        |     |     sort order:+
                     |        |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                     |        |     |     value expressions:value (type: string)
                     |        |     |     Filter Operator [FIL_101]
                     |        |     |        predicate:(key is not null and value is not null) (type: boolean)
                     |        |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                     |        |     |        TableScan [TS_48]
                     |        |     |           alias:x
                     |        |     |           Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                     |        |     |<-Filter Operator [FIL_102]
                     |        |           predicate:key is not null (type: boolean)
                     |        |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                     |        |           TableScan [TS_49]
                     |        |              alias:y
                     |        |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                     |        |  Reduce Output Operator [RS_111]
                     |        |     key expressions:_col1 (type: string)
                     |        |     Map-reduce partition columns:_col1 (type: string)
                     |        |     sort order:+
                     |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                     |        |     value expressions:_col0 (type: string), _col6 (type: string)
                     |        |      Please refer to the previous Map Join Operator [MAPJOIN_105]
                     |        |  Reduce Output Operator [RS_112]
                     |        |     key expressions:_col1 (type: string)
                     |        |     Map-reduce partition columns:_col1 (type: string)
                     |        |     sort order:+
                     |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                     |        |     value expressions:_col0 (type: string), _col6 (type: string)
                     |        |      Please refer to the previous Map Join Operator [MAPJOIN_105]
                     |        |  Reduce Output Operator [RS_113]
                     |        |     key expressions:_col1 (type: string)
                     |        |     Map-reduce partition columns:_col1 (type: string)
                     |        |     sort order:+
                     |        |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                     |        |     value expressions:_col0 (type: string), _col6 (type: string)
                     |        |      Please refer to the previous Map Join Operator [MAPJOIN_105]
                     |        |<-Select Operator [SEL_47]
                     |              outputColumnNames:["_col1"]
                     |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |              Filter Operator [FIL_100]
                     |                 predicate:value is not null (type: boolean)
                     |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |                 TableScan [TS_46]
                     |                    alias:src
                     |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |  File Output Operator [FS_64]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |  File Output Operator [FS_66]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |<-Map 16 [CONTAINS]
                     |  File Output Operator [FS_62]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |     Select Operator [SEL_60]
                     |        outputColumnNames:["_col0","_col1"]
                     |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        Map Join Operator [MAPJOIN_108]
                     |        |  condition map:[{"":"Inner Join 0 to 1"}]
                     |        |  keys:{"Map 21":"_col1 (type: string)","Map 16":"_col1 (type: string)"}
                     |        |  outputColumnNames:["_col0","_col6"]
                     |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        |<- Please refer to the previous Map 21 [BROADCAST_EDGE]
                     |        |<-Select Operator [SEL_40]
                     |              outputColumnNames:["_col1"]
                     |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                     |              Filter Operator [FIL_97]
                     |                 predicate:value is not null (type: boolean)
                     |                 Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                     |                 TableScan [TS_39]
                     |                    alias:src1
                     |                    Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                     |  File Output Operator [FS_64]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |  File Output Operator [FS_66]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |<-Map 18 [CONTAINS]
                     |  File Output Operator [FS_62]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |     Select Operator [SEL_60]
                     |        outputColumnNames:["_col0","_col1"]
                     |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        Map Join Operator [MAPJOIN_108]
                     |        |  condition map:[{"":"Inner Join 0 to 1"}]
                     |        |  keys:{"Map 21":"_col1 (type: string)","Map 18":"_col1 (type: string)"}
                     |        |  outputColumnNames:["_col0","_col6"]
                     |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        |<- Please refer to the previous Map 21 [BROADCAST_EDGE]
                     |        |<-Select Operator [SEL_45]
                     |              outputColumnNames:["_col1"]
                     |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |              Filter Operator [FIL_99]
                     |                 predicate:value is not null (type: boolean)
                     |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |                 TableScan [TS_44]
                     |                    alias:src
                     |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |  File Output Operator [FS_64]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |  File Output Operator [FS_66]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |<-Map 17 [CONTAINS]
                     |  File Output Operator [FS_62]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |     Select Operator [SEL_60]
                     |        outputColumnNames:["_col0","_col1"]
                     |        Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        Map Join Operator [MAPJOIN_108]
                     |        |  condition map:[{"":"Inner Join 0 to 1"}]
                     |        |  keys:{"Map 21":"_col1 (type: string)","Map 17":"_col1 (type: string)"}
                     |        |  outputColumnNames:["_col0","_col6"]
                     |        |  Statistics:Num rows: 839 Data size: 8873 Basic stats: COMPLETE Column stats: NONE
                     |        |<- Please refer to the previous Map 21 [BROADCAST_EDGE]
                     |        |<-Select Operator [SEL_42]
                     |              outputColumnNames:["_col1"]
                     |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |              Filter Operator [FIL_98]
                     |                 predicate:value is not null (type: boolean)
                     |                 Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     |                 TableScan [TS_41]
                     |                    alias:src
                     |                    Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     |  File Output Operator [FS_64]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |  File Output Operator [FS_66]
                     |     compressed:false
                     |     Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                     |     table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                     |      Please refer to the previous Select Operator [SEL_60]
                     |<-Reducer 3 [CONTAINS]
                        File Output Operator [FS_62]
                           compressed:false
                           Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                           table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                           Select Operator [SEL_17]
                              outputColumnNames:["_col0","_col1"]
                              Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
                              Merge Join Operator [MERGEJOIN_106]
                              |  condition map:[{"":"Inner Join 0 to 1"}]
                              |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                              |  outputColumnNames:["_col0","_col6"]
                              |  Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
                              |<-Map 7 [SIMPLE_EDGE]
                              |  Reduce Output Operator [RS_13]
                              |     key expressions:_col1 (type: string)
                              |     Map-reduce partition columns:_col1 (type: string)
                              |     sort order:+
                              |     Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                              |     value expressions:_col0 (type: string), _col6 (type: string)
                              |     Map Join Operator [MAPJOIN_103]
                              |     |  condition map:[{"":"Inner Join 0 to 1"}]
                              |     |  keys:{"Map 7":"key (type: string)","Map 6":"key (type: string)"}
                              |     |  outputColumnNames:["_col0","_col1","_col6"]
                              |     |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                              |     |<-Map 6 [BROADCAST_EDGE]
                              |     |  Reduce Output Operator [RS_8]
                              |     |     key expressions:key (type: string)
                              |     |     Map-reduce partition columns:key (type: string)
                              |     |     sort order:+
                              |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                              |     |     value expressions:value (type: string)
                              |     |     Filter Operator [FIL_90]
                              |     |        predicate:(key is not null and value is not null) (type: boolean)
                              |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                              |     |        TableScan [TS_5]
                              |     |           alias:x
                              |     |           Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                              |     |<-Filter Operator [FIL_91]
                              |           predicate:key is not null (type: boolean)
                              |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                              |           TableScan [TS_6]
                              |              alias:y
                              |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                              |<-Union 2 [SIMPLE_EDGE]
                                 |<-Map 1 [CONTAINS]
                                 |  Reduce Output Operator [RS_15]
                                 |     key expressions:_col1 (type: string)
                                 |     Map-reduce partition columns:_col1 (type: string)
                                 |     sort order:+
                                 |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                 |     Select Operator [SEL_1]
                                 |        outputColumnNames:["_col1"]
                                 |        Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                 |        Filter Operator [FIL_88]
                                 |           predicate:value is not null (type: boolean)
                                 |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                 |           TableScan [TS_0]
                                 |              alias:src1
                                 |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                 |<-Map 5 [CONTAINS]
                                    Reduce Output Operator [RS_15]
                                       key expressions:_col1 (type: string)
                                       Map-reduce partition columns:_col1 (type: string)
                                       sort order:+
                                       Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                       Select Operator [SEL_3]
                                          outputColumnNames:["_col1"]
                                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                          Filter Operator [FIL_89]
                                             predicate:value is not null (type: boolean)
                                             Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                             TableScan [TS_2]
                                                alias:src
                                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator [FS_64]
                           compressed:false
                           Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                           table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                            Please refer to the previous Select Operator [SEL_17]
                        File Output Operator [FS_66]
                           compressed:false
                           Statistics:Num rows: 1705 Data size: 18038 Basic stats: COMPLETE Column stats: NONE
                           table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                            Please refer to the previous Select Operator [SEL_17]
Stage-14
   Stats-Aggr Operator
      Stage-0
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-4
Stage-13
   Stats-Aggr Operator
      Stage-2
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-4
Stage-12
   Stats-Aggr Operator
       Please refer to the previous Stage-1
Stage-19
   Stats-Aggr Operator
       Please refer to the previous Stage-2
Stage-18
   Stats-Aggr Operator
       Please refer to the previous Stage-1
Stage-17
   Stats-Aggr Operator
       Please refer to the previous Stage-0
Stage-16
   Stats-Aggr Operator
       Please refer to the previous Stage-2
Stage-20
   Stats-Aggr Operator
       Please refer to the previous Stage-0
Stage-9
   Stats-Aggr Operator
       Please refer to the previous Stage-1
Stage-22
   Stats-Aggr Operator
       Please refer to the previous Stage-2
Stage-8
   Stats-Aggr Operator
       Please refer to the previous Stage-0
Stage-21
   Stats-Aggr Operator
       Please refer to the previous Stage-1
Stage-7
   Stats-Aggr Operator
       Please refer to the previous Stage-2
Stage-6
   Stats-Aggr Operator
       Please refer to the previous Stage-1
Stage-10
   Stats-Aggr Operator
       Please refer to the previous Stage-2
Stage-11
   Stats-Aggr Operator
       Please refer to the previous Stage-0
Stage-5
   Stats-Aggr Operator
       Please refer to the previous Stage-0
PREHOOK: query: explain
FROM
( 
SELECT x.key as key, y.value as value from src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value) 
union
SELECT x.key as key, y.value as value from src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key as key, y.value as value from src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
FROM
( 
SELECT x.key as key, y.value as value from src1 x JOIN src y ON (x.key = y.key) 
JOIN (select * from src1 union select * from src)z ON (x.value = z.value) 
union
SELECT x.key as key, y.value as value from src x JOIN src y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src)z ON (x.value = z.value)
union
SELECT x.key as key, y.value as value from src1 x JOIN src1 y ON (x.key = y.key) 
JOIN (select key, value from src1 union select key, value from src union select key, value from src union select key, value from src)z ON (x.value = z.value)
) tmp
INSERT OVERWRITE TABLE a SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE b SELECT tmp.key, tmp.value
INSERT OVERWRITE TABLE c SELECT tmp.key, tmp.value
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Map 12 <- Union 13 (CONTAINS)
Map 30 <- Union 24 (CONTAINS)
Map 11 <- Map 10 (BROADCAST_EDGE)
Reducer 14 <- Union 13 (SIMPLE_EDGE), Union 15 (CONTAINS)
Map 23 <- Union 24 (CONTAINS)
Map 32 <- Union 28 (CONTAINS)
Reducer 25 <- Union 24 (SIMPLE_EDGE), Union 26 (CONTAINS)
Map 31 <- Union 26 (CONTAINS)
Map 34 <- Map 33 (BROADCAST_EDGE)
Map 1 <- Union 2 (CONTAINS)
Reducer 21 <- Map 20 (SIMPLE_EDGE), Map 22 (SIMPLE_EDGE)
Reducer 4 <- Map 11 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
Map 19 <- Union 15 (CONTAINS)
Reducer 6 <- Union 5 (SIMPLE_EDGE), Union 7 (CONTAINS)
Reducer 17 <- Reducer 16 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE), Union 5 (CONTAINS)
Reducer 8 <- Union 7 (SIMPLE_EDGE)
Reducer 27 <- Union 26 (SIMPLE_EDGE), Union 28 (CONTAINS)
Map 18 <- Union 13 (CONTAINS)
Reducer 29 <- Map 34 (BROADCAST_EDGE), Union 28 (SIMPLE_EDGE), Union 7 (CONTAINS)
Reducer 16 <- Union 15 (SIMPLE_EDGE)
Reducer 3 <- Union 2 (SIMPLE_EDGE)
Map 9 <- Union 2 (CONTAINS)

Stage-7
   Stats-Aggr Operator
      Stage-2
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Stage-4
               Dependency Collection{}
                  Stage-3
                     Reducer 8
                     File Output Operator [FS_114]
                        compressed:false
                        Statistics:Num rows: 272 Data size: 2889 Basic stats: COMPLETE Column stats: NONE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Group By Operator [GBY_111]
                        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 272 Data size: 2889 Basic stats: COMPLETE Column stats: NONE
                        |<-Union 7 [SIMPLE_EDGE]
                           |<-Reducer 6 [CONTAINS]
                           |  Reduce Output Operator [RS_110]
                           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |     sort order:++
                           |     Statistics:Num rows: 544 Data size: 5778 Basic stats: COMPLETE Column stats: NONE
                           |     Group By Operator [GBY_109]
                           |        keys:_col0 (type: string), _col1 (type: string)
                           |        outputColumnNames:["_col0","_col1"]
                           |        Statistics:Num rows: 544 Data size: 5778 Basic stats: COMPLETE Column stats: NONE
                           |        Group By Operator [GBY_62]
                           |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |        |  outputColumnNames:["_col0","_col1"]
                           |        |  Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
                           |        |<-Union 5 [SIMPLE_EDGE]
                           |           |<-Reducer 4 [CONTAINS]
                           |           |  Reduce Output Operator [RS_61]
                           |           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |           |     sort order:++
                           |           |     Statistics:Num rows: 604 Data size: 6426 Basic stats: COMPLETE Column stats: NONE
                           |           |     Group By Operator [GBY_60]
                           |           |        keys:_col0 (type: string), _col1 (type: string)
                           |           |        outputColumnNames:["_col0","_col1"]
                           |           |        Statistics:Num rows: 604 Data size: 6426 Basic stats: COMPLETE Column stats: NONE
                           |           |        Select Operator [SEL_23]
                           |           |           outputColumnNames:["_col0","_col1"]
                           |           |           Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
                           |           |           Merge Join Operator [MERGEJOIN_158]
                           |           |           |  condition map:[{"":"Inner Join 0 to 1"}]
                           |           |           |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                           |           |           |  outputColumnNames:["_col0","_col6"]
                           |           |           |  Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
                           |           |           |<-Map 11 [SIMPLE_EDGE]
                           |           |           |  Reduce Output Operator [RS_19]
                           |           |           |     key expressions:_col1 (type: string)
                           |           |           |     Map-reduce partition columns:_col1 (type: string)
                           |           |           |     sort order:+
                           |           |           |     Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |           |           |     value expressions:_col0 (type: string), _col6 (type: string)
                           |           |           |     Map Join Operator [MAPJOIN_155]
                           |           |           |     |  condition map:[{"":"Inner Join 0 to 1"}]
                           |           |           |     |  keys:{"Map 11":"key (type: string)","Map 10":"key (type: string)"}
                           |           |           |     |  outputColumnNames:["_col0","_col1","_col6"]
                           |           |           |     |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |           |           |     |<-Map 10 [BROADCAST_EDGE]
                           |           |           |     |  Reduce Output Operator [RS_14]
                           |           |           |     |     key expressions:key (type: string)
                           |           |           |     |     Map-reduce partition columns:key (type: string)
                           |           |           |     |     sort order:+
                           |           |           |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |           |           |     |     value expressions:value (type: string)
                           |           |           |     |     Filter Operator [FIL_142]
                           |           |           |     |        predicate:(key is not null and value is not null) (type: boolean)
                           |           |           |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                           |           |           |     |        TableScan [TS_11]
                           |           |           |     |           alias:x
                           |           |           |     |           Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |           |           |     |<-Filter Operator [FIL_143]
                           |           |           |           predicate:key is not null (type: boolean)
                           |           |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |           |           TableScan [TS_12]
                           |           |           |              alias:y
                           |           |           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |           |           |<-Reducer 3 [SIMPLE_EDGE]
                           |           |              Reduce Output Operator [RS_21]
                           |           |                 key expressions:_col1 (type: string)
                           |           |                 Map-reduce partition columns:_col1 (type: string)
                           |           |                 sort order:+
                           |           |                 Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |           |                 Select Operator [SEL_10]
                           |           |                    outputColumnNames:["_col1"]
                           |           |                    Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |           |                    Group By Operator [GBY_9]
                           |           |                    |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |           |                    |  outputColumnNames:["_col0","_col1"]
                           |           |                    |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |           |                    |<-Union 2 [SIMPLE_EDGE]
                           |           |                       |<-Map 1 [CONTAINS]
                           |           |                       |  Reduce Output Operator [RS_8]
                           |           |                       |     key expressions:_col0 (type: string), _col1 (type: string)
                           |           |                       |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |           |                       |     sort order:++
                           |           |                       |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |                       |     Group By Operator [GBY_7]
                           |           |                       |        keys:_col0 (type: string), _col1 (type: string)
                           |           |                       |        outputColumnNames:["_col0","_col1"]
                           |           |                       |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |                       |        Select Operator [SEL_1]
                           |           |                       |           outputColumnNames:["_col0","_col1"]
                           |           |                       |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |           |                       |           Filter Operator [FIL_140]
                           |           |                       |              predicate:value is not null (type: boolean)
                           |           |                       |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |           |                       |              TableScan [TS_0]
                           |           |                       |                 alias:src1
                           |           |                       |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |           |                       |<-Map 9 [CONTAINS]
                           |           |                          Reduce Output Operator [RS_8]
                           |           |                             key expressions:_col0 (type: string), _col1 (type: string)
                           |           |                             Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |           |                             sort order:++
                           |           |                             Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |                             Group By Operator [GBY_7]
                           |           |                                keys:_col0 (type: string), _col1 (type: string)
                           |           |                                outputColumnNames:["_col0","_col1"]
                           |           |                                Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |           |                                Select Operator [SEL_3]
                           |           |                                   outputColumnNames:["_col0","_col1"]
                           |           |                                   Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |                                   Filter Operator [FIL_141]
                           |           |                                      predicate:value is not null (type: boolean)
                           |           |                                      Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |           |                                      TableScan [TS_2]
                           |           |                                         alias:src
                           |           |                                         Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |           |<-Reducer 17 [CONTAINS]
                           |              Reduce Output Operator [RS_61]
                           |                 key expressions:_col0 (type: string), _col1 (type: string)
                           |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                 sort order:++
                           |                 Statistics:Num rows: 604 Data size: 6426 Basic stats: COMPLETE Column stats: NONE
                           |                 Group By Operator [GBY_60]
                           |                    keys:_col0 (type: string), _col1 (type: string)
                           |                    outputColumnNames:["_col0","_col1"]
                           |                    Statistics:Num rows: 604 Data size: 6426 Basic stats: COMPLETE Column stats: NONE
                           |                    Select Operator [SEL_56]
                           |                       outputColumnNames:["_col0","_col1"]
                           |                       Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
                           |                       Merge Join Operator [MERGEJOIN_159]
                           |                       |  condition map:[{"":"Inner Join 0 to 1"}]
                           |                       |  keys:{"1":"_col1 (type: string)","0":"_col1 (type: string)"}
                           |                       |  outputColumnNames:["_col0","_col6"]
                           |                       |  Statistics:Num rows: 302 Data size: 3213 Basic stats: COMPLETE Column stats: NONE
                           |                       |<-Reducer 16 [SIMPLE_EDGE]
                           |                       |  Reduce Output Operator [RS_54]
                           |                       |     key expressions:_col1 (type: string)
                           |                       |     Map-reduce partition columns:_col1 (type: string)
                           |                       |     sort order:+
                           |                       |     Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |                       |     Select Operator [SEL_43]
                           |                       |        outputColumnNames:["_col1"]
                           |                       |        Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |                       |        Group By Operator [GBY_42]
                           |                       |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |                       |        |  outputColumnNames:["_col0","_col1"]
                           |                       |        |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                           |                       |        |<-Union 15 [SIMPLE_EDGE]
                           |                       |           |<-Reducer 14 [CONTAINS]
                           |                       |           |  Reduce Output Operator [RS_41]
                           |                       |           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |                       |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                       |           |     sort order:++
                           |                       |           |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |     Group By Operator [GBY_40]
                           |                       |           |        keys:_col0 (type: string), _col1 (type: string)
                           |                       |           |        outputColumnNames:["_col0","_col1"]
                           |                       |           |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |        Group By Operator [GBY_33]
                           |                       |           |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                           |                       |           |        |  outputColumnNames:["_col0","_col1"]
                           |                       |           |        |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |        |<-Union 13 [SIMPLE_EDGE]
                           |                       |           |           |<-Map 12 [CONTAINS]
                           |                       |           |           |  Reduce Output Operator [RS_32]
                           |                       |           |           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |                       |           |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                       |           |           |     sort order:++
                           |                       |           |           |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |           |     Group By Operator [GBY_31]
                           |                       |           |           |        keys:_col0 (type: string), _col1 (type: string)
                           |                       |           |           |        outputColumnNames:["_col0","_col1"]
                           |                       |           |           |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |           |        Select Operator [SEL_25]
                           |                       |           |           |           outputColumnNames:["_col0","_col1"]
                           |                       |           |           |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |           |           Filter Operator [FIL_144]
                           |                       |           |           |              predicate:value is not null (type: boolean)
                           |                       |           |           |              Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |           |              TableScan [TS_24]
                           |                       |           |           |                 alias:src1
                           |                       |           |           |                 Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |           |<-Map 18 [CONTAINS]
                           |                       |           |              Reduce Output Operator [RS_32]
                           |                       |           |                 key expressions:_col0 (type: string), _col1 (type: string)
                           |                       |           |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                       |           |                 sort order:++
                           |                       |           |                 Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |                 Group By Operator [GBY_31]
                           |                       |           |                    keys:_col0 (type: string), _col1 (type: string)
                           |                       |           |                    outputColumnNames:["_col0","_col1"]
                           |                       |           |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |                    Select Operator [SEL_27]
                           |                       |           |                       outputColumnNames:["_col0","_col1"]
                           |                       |           |                       Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |                       Filter Operator [FIL_145]
                           |                       |           |                          predicate:value is not null (type: boolean)
                           |                       |           |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |                          TableScan [TS_26]
                           |                       |           |                             alias:src
                           |                       |           |                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |                       |           |<-Map 19 [CONTAINS]
                           |                       |              Reduce Output Operator [RS_41]
                           |                       |                 key expressions:_col0 (type: string), _col1 (type: string)
                           |                       |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |                       |                 sort order:++
                           |                       |                 Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                       |                 Group By Operator [GBY_40]
                           |                       |                    keys:_col0 (type: string), _col1 (type: string)
                           |                       |                    outputColumnNames:["_col0","_col1"]
                           |                       |                    Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                           |                       |                    Select Operator [SEL_36]
                           |                       |                       outputColumnNames:["_col0","_col1"]
                           |                       |                       Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                       |                       Filter Operator [FIL_146]
                           |                       |                          predicate:value is not null (type: boolean)
                           |                       |                          Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                       |                          TableScan [TS_35]
                           |                       |                             alias:src
                           |                       |                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |                       |<-Reducer 21 [SIMPLE_EDGE]
                           |                          Reduce Output Operator [RS_52]
                           |                             key expressions:_col1 (type: string)
                           |                             Map-reduce partition columns:_col1 (type: string)
                           |                             sort order:+
                           |                             Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |                             value expressions:_col0 (type: string), _col6 (type: string)
                           |                             Merge Join Operator [MERGEJOIN_156]
                           |                             |  condition map:[{"":"Inner Join 0 to 1"}]
                           |                             |  keys:{"1":"key (type: string)","0":"key (type: string)"}
                           |                             |  outputColumnNames:["_col0","_col1","_col6"]
                           |                             |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
                           |                             |<-Map 20 [SIMPLE_EDGE]
                           |                             |  Reduce Output Operator [RS_47]
                           |                             |     key expressions:key (type: string)
                           |                             |     Map-reduce partition columns:key (type: string)
                           |                             |     sort order:+
                           |                             |     Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                           |                             |     value expressions:value (type: string)
                           |                             |     Filter Operator [FIL_147]
                           |                             |        predicate:(key is not null and value is not null) (type: boolean)
                           |                             |        Statistics:Num rows: 125 Data size: 1328 Basic stats: COMPLETE Column stats: NONE
                           |                             |        TableScan [TS_44]
                           |                             |           alias:x
                           |                             |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |                             |<-Map 22 [SIMPLE_EDGE]
                           |                                Reduce Output Operator [RS_49]
                           |                                   key expressions:key (type: string)
                           |                                   Map-reduce partition columns:key (type: string)
                           |                                   sort order:+
                           |                                   Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                                   value expressions:value (type: string)
                           |                                   Filter Operator [FIL_148]
                           |                                      predicate:key is not null (type: boolean)
                           |                                      Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                           |                                      TableScan [TS_45]
                           |                                         alias:y
                           |                                         Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |<-Reducer 29 [CONTAINS]
                              Reduce Output Operator [RS_110]
                                 key expressions:_col0 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 544 Data size: 5778 Basic stats: COMPLETE Column stats: NONE
                                 Group By Operator [GBY_109]
                                    keys:_col0 (type: string), _col1 (type: string)
                                    outputColumnNames:["_col0","_col1"]
                                    Statistics:Num rows: 544 Data size: 5778 Basic stats: COMPLETE Column stats: NONE
                                    Select Operator [SEL_105]
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
                                       Map Join Operator [MAPJOIN_160]
                                       |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |  keys:{"Map 34":"_col1 (type: string)","Reducer 29":"_col1 (type: string)"}
                                       |  outputColumnNames:["_col0","_col6"]
                                       |  Statistics:Num rows: 242 Data size: 2565 Basic stats: COMPLETE Column stats: NONE
                                       |<-Map 34 [BROADCAST_EDGE]
                                       |  Reduce Output Operator [RS_101]
                                       |     key expressions:_col1 (type: string)
                                       |     Map-reduce partition columns:_col1 (type: string)
                                       |     sort order:+
                                       |     Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                                       |     value expressions:_col0 (type: string), _col6 (type: string)
                                       |     Map Join Operator [MAPJOIN_157]
                                       |     |  condition map:[{"":"Inner Join 0 to 1"}]
                                       |     |  keys:{"Map 34":"key (type: string)","Map 33":"key (type: string)"}
                                       |     |  outputColumnNames:["_col0","_col1","_col6"]
                                       |     |  Statistics:Num rows: 14 Data size: 108 Basic stats: COMPLETE Column stats: NONE
                                       |     |<-Map 33 [BROADCAST_EDGE]
                                       |     |  Reduce Output Operator [RS_96]
                                       |     |     key expressions:key (type: string)
                                       |     |     Map-reduce partition columns:key (type: string)
                                       |     |     sort order:+
                                       |     |     Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                       |     |     value expressions:value (type: string)
                                       |     |     Filter Operator [FIL_153]
                                       |     |        predicate:(key is not null and value is not null) (type: boolean)
                                       |     |        Statistics:Num rows: 7 Data size: 53 Basic stats: COMPLETE Column stats: NONE
                                       |     |        TableScan [TS_93]
                                       |     |           alias:x
                                       |     |           Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                       |     |<-Filter Operator [FIL_154]
                                       |           predicate:key is not null (type: boolean)
                                       |           Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                       |           TableScan [TS_94]
                                       |              alias:y
                                       |              Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                       |<-Select Operator [SEL_92]
                                             outputColumnNames:["_col1"]
                                             Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
                                             Group By Operator [GBY_91]
                                             |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                             |  outputColumnNames:["_col0","_col1"]
                                             |  Statistics:Num rows: 220 Data size: 2332 Basic stats: COMPLETE Column stats: NONE
                                             |<-Union 28 [SIMPLE_EDGE]
                                                |<-Map 32 [CONTAINS]
                                                |  Reduce Output Operator [RS_90]
                                                |     key expressions:_col0 (type: string), _col1 (type: string)
                                                |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                |     sort order:++
                                                |     Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                                |     Group By Operator [GBY_89]
                                                |        keys:_col0 (type: string), _col1 (type: string)
                                                |        outputColumnNames:["_col0","_col1"]
                                                |        Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                                |        Select Operator [SEL_85]
                                                |           outputColumnNames:["_col0","_col1"]
                                                |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                |           Filter Operator [FIL_152]
                                                |              predicate:value is not null (type: boolean)
                                                |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                |              TableScan [TS_84]
                                                |                 alias:src
                                                |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                |<-Reducer 27 [CONTAINS]
                                                   Reduce Output Operator [RS_90]
                                                      key expressions:_col0 (type: string), _col1 (type: string)
                                                      Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                      sort order:++
                                                      Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                                      Group By Operator [GBY_89]
                                                         keys:_col0 (type: string), _col1 (type: string)
                                                         outputColumnNames:["_col0","_col1"]
                                                         Statistics:Num rows: 440 Data size: 4664 Basic stats: COMPLETE Column stats: NONE
                                                         Group By Operator [GBY_82]
                                                         |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                                         |  outputColumnNames:["_col0","_col1"]
                                                         |  Statistics:Num rows: 190 Data size: 2008 Basic stats: COMPLETE Column stats: NONE
                                                         |<-Union 26 [SIMPLE_EDGE]
                                                            |<-Reducer 25 [CONTAINS]
                                                            |  Reduce Output Operator [RS_81]
                                                            |     key expressions:_col0 (type: string), _col1 (type: string)
                                                            |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                            |     sort order:++
                                                            |     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                            |     Group By Operator [GBY_80]
                                                            |        keys:_col0 (type: string), _col1 (type: string)
                                                            |        outputColumnNames:["_col0","_col1"]
                                                            |        Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                            |        Group By Operator [GBY_73]
                                                            |        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                                            |        |  outputColumnNames:["_col0","_col1"]
                                                            |        |  Statistics:Num rows: 131 Data size: 1372 Basic stats: COMPLETE Column stats: NONE
                                                            |        |<-Union 24 [SIMPLE_EDGE]
                                                            |           |<-Map 30 [CONTAINS]
                                                            |           |  Reduce Output Operator [RS_72]
                                                            |           |     key expressions:_col0 (type: string), _col1 (type: string)
                                                            |           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                            |           |     sort order:++
                                                            |           |     Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                            |           |     Group By Operator [GBY_71]
                                                            |           |        keys:_col0 (type: string), _col1 (type: string)
                                                            |           |        outputColumnNames:["_col0","_col1"]
                                                            |           |        Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                            |           |        Select Operator [SEL_67]
                                                            |           |           outputColumnNames:["_col0","_col1"]
                                                            |           |           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                            |           |           Filter Operator [FIL_150]
                                                            |           |              predicate:value is not null (type: boolean)
                                                            |           |              Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                            |           |              TableScan [TS_66]
                                                            |           |                 alias:src
                                                            |           |                 Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                            |           |<-Map 23 [CONTAINS]
                                                            |              Reduce Output Operator [RS_72]
                                                            |                 key expressions:_col0 (type: string), _col1 (type: string)
                                                            |                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                            |                 sort order:++
                                                            |                 Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                            |                 Group By Operator [GBY_71]
                                                            |                    keys:_col0 (type: string), _col1 (type: string)
                                                            |                    outputColumnNames:["_col0","_col1"]
                                                            |                    Statistics:Num rows: 263 Data size: 2755 Basic stats: COMPLETE Column stats: NONE
                                                            |                    Select Operator [SEL_65]
                                                            |                       outputColumnNames:["_col0","_col1"]
                                                            |                       Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                                            |                       Filter Operator [FIL_149]
                                                            |                          predicate:value is not null (type: boolean)
                                                            |                          Statistics:Num rows: 13 Data size: 99 Basic stats: COMPLETE Column stats: NONE
                                                            |                          TableScan [TS_64]
                                                            |                             alias:src1
                                                            |                             Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
                                                            |<-Map 31 [CONTAINS]
                                                               Reduce Output Operator [RS_81]
                                                                  key expressions:_col0 (type: string), _col1 (type: string)
                                                                  Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                                                  sort order:++
                                                                  Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                                  Group By Operator [GBY_80]
                                                                     keys:_col0 (type: string), _col1 (type: string)
                                                                     outputColumnNames:["_col0","_col1"]
                                                                     Statistics:Num rows: 381 Data size: 4028 Basic stats: COMPLETE Column stats: NONE
                                                                     Select Operator [SEL_76]
                                                                        outputColumnNames:["_col0","_col1"]
                                                                        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                                        Filter Operator [FIL_151]
                                                                           predicate:value is not null (type: boolean)
                                                                           Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                                                                           TableScan [TS_75]
                                                                              alias:src
                                                                              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     File Output Operator [FS_116]
                        compressed:false
                        Statistics:Num rows: 272 Data size: 2889 Basic stats: COMPLETE Column stats: NONE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                         Please refer to the previous Group By Operator [GBY_111]
                     File Output Operator [FS_118]
                        compressed:false
                        Statistics:Num rows: 272 Data size: 2889 Basic stats: COMPLETE Column stats: NONE
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.c","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                         Please refer to the previous Group By Operator [GBY_111]
Stage-6
   Stats-Aggr Operator
      Stage-1
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.b","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-4
Stage-5
   Stats-Aggr Operator
      Stage-0
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.a","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-4
PREHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@DEST1
POSTHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@DEST1
PREHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@DEST2
POSTHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@DEST2
PREHOOK: query: explain 
FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
                         UNION DISTINCT  
      select s2.key as key, s2.value as value from src s2) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key, unionsrc.value
PREHOOK: type: QUERY
POSTHOOK: query: explain 
FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
                         UNION DISTINCT  
      select s2.key as key, s2.value as value from src s2) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key, unionsrc.value
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Map 6 <- Union 3 (CONTAINS)

Stage-5
   Stats-Aggr Operator
      Stage-1
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest2","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Stage-3
               Dependency Collection{}
                  Stage-2
                     Reducer 5
                     File Output Operator [FS_20]
                        compressed:false
                        Statistics:Num rows: 1 Data size: 96 Basic stats: COMPLETE Column stats: PARTIAL
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Group By Operator [GBY_18]
                        |  aggregations:["count(DISTINCT KEY._col1:0._col0)"]
                        |  keys:KEY._col0 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 1 Data size: 96 Basic stats: COMPLETE Column stats: PARTIAL
                        |<-Reducer 4 [SIMPLE_EDGE]
                           Reduce Output Operator [RS_17]
                              key expressions:_col0 (type: string), _col1 (type: string)
                              Map-reduce partition columns:_col0 (type: string)
                              sort order:++
                              Statistics:Num rows: 1 Data size: 280 Basic stats: COMPLETE Column stats: PARTIAL
                              Group By Operator [GBY_16]
                                 aggregations:["count(DISTINCT substr(_col1, 5))"]
                                 keys:_col0 (type: string), substr(_col1, 5) (type: string)
                                 outputColumnNames:["_col0","_col1","_col2"]
                                 Statistics:Num rows: 1 Data size: 280 Basic stats: COMPLETE Column stats: PARTIAL
                                 Group By Operator [GBY_13]
                                 |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                                 |  outputColumnNames:["_col0","_col1"]
                                 |  Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: PARTIAL
                                 |<-Union 3 [SIMPLE_EDGE]
                                    |<-Reducer 2 [CONTAINS]
                                    |  Reduce Output Operator [RS_12]
                                    |     key expressions:_col0 (type: string), _col1 (type: string), substr(_col1, 5) (type: string)
                                    |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                    |     sort order:+++
                                    |     Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: PARTIAL
                                    |     Group By Operator [GBY_11]
                                    |        keys:_col0 (type: string), _col1 (type: string)
                                    |        outputColumnNames:["_col0","_col1"]
                                    |        Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: PARTIAL
                                    |        Select Operator [SEL_5]
                                    |           outputColumnNames:["_col0","_col1"]
                                    |           Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
                                    |           Group By Operator [GBY_4]
                                    |           |  aggregations:["count(VALUE._col0)"]
                                    |           |  outputColumnNames:["_col0"]
                                    |           |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                    |           |<-Map 1 [SIMPLE_EDGE]
                                    |              Reduce Output Operator [RS_3]
                                    |                 sort order:
                                    |                 Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                    |                 value expressions:_col0 (type: bigint)
                                    |                 Group By Operator [GBY_2]
                                    |                    aggregations:["count(1)"]
                                    |                    outputColumnNames:["_col0"]
                                    |                    Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                    |                    Select Operator [SEL_1]
                                    |                       Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                                    |                       TableScan [TS_0]
                                    |                          alias:s1
                                    |                          Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                                    |<-Map 6 [CONTAINS]
                                       Reduce Output Operator [RS_12]
                                          key expressions:_col0 (type: string), _col1 (type: string), substr(_col1, 5) (type: string)
                                          Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                          sort order:+++
                                          Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: PARTIAL
                                          Group By Operator [GBY_11]
                                             keys:_col0 (type: string), _col1 (type: string)
                                             outputColumnNames:["_col0","_col1"]
                                             Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: PARTIAL
                                             Select Operator [SEL_7]
                                                outputColumnNames:["_col0","_col1"]
                                                Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                                TableScan [TS_6]
                                                   alias:s2
                                                   Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           File Output Operator [FS_26]
                              compressed:false
                              Statistics:Num rows: 1 Data size: 456 Basic stats: COMPLETE Column stats: PARTIAL
                              table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest2","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                              Select Operator [SEL_25]
                                 outputColumnNames:["_col0","_col1","_col2"]
                                 Statistics:Num rows: 1 Data size: 456 Basic stats: COMPLETE Column stats: PARTIAL
                                 Group By Operator [GBY_24]
                                    aggregations:["count(DISTINCT substr(_col1, 5))"]
                                    keys:_col0 (type: string), _col1 (type: string)
                                    outputColumnNames:["_col0","_col1","_col2"]
                                    Statistics:Num rows: 1 Data size: 464 Basic stats: COMPLETE Column stats: PARTIAL
                                     Please refer to the previous Group By Operator [GBY_13]
Stage-4
   Stats-Aggr Operator
      Stage-0
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-3
PREHOOK: query: EXPLAIN FROM UNIQUEJOIN PRESERVE src a (a.key), PRESERVE src1 b (b.key), PRESERVE srcpart c (c.key) SELECT a.key, b.key, c.key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN FROM UNIQUEJOIN PRESERVE src a (a.key), PRESERVE src1 b (b.key), PRESERVE srcpart c (c.key) SELECT a.key, b.key, c.key
POSTHOOK: type: QUERY
Plan not optimized by CBO due to missing feature [Unique_join].

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_8]
            compressed:false
            Statistics:Num rows: 4400 Data size: 46745 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Select Operator [SEL_7]
               outputColumnNames:["_col0","_col1","_col2"]
               Statistics:Num rows: 4400 Data size: 46745 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_9]
               |  condition map:[{"":"Unique Join0 to 0"},{"":"Unique Join0 to 0"},{"":"Unique Join0 to 0"}]
               |  keys:{"2":"key (type: string)","1":"key (type: string)","0":"key (type: string)"}
               |  outputColumnNames:["_col0","_col5","_col10"]
               |  Statistics:Num rows: 4400 Data size: 46745 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_3]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |     TableScan [TS_0]
               |        alias:a
               |        Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_4]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |     TableScan [TS_1]
               |        alias:b
               |        Statistics:Num rows: 25 Data size: 191 Basic stats: COMPLETE Column stats: NONE
               |<-Map 4 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_5]
                     key expressions:key (type: string)
                     Map-reduce partition columns:key (type: string)
                     sort order:+
                     Statistics:Num rows: 2000 Data size: 21248 Basic stats: COMPLETE Column stats: NONE
                     TableScan [TS_2]
                        alias:c
                        Statistics:Num rows: 2000 Data size: 21248 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: EXPLAIN
SELECT 
TRANSFORM(a.key, a.value) USING 'cat' AS (tkey, tvalue)
FROM src a join src b
on a.key = b.key
PREHOOK: type: QUERY
POSTHOOK: query: EXPLAIN
SELECT 
TRANSFORM(a.key, a.value) USING 'cat' AS (tkey, tvalue)
FROM src a join src b
on a.key = b.key
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE)

Stage-0
   Fetch Operator
      limit:-1
      Stage-1
         Reducer 2
         File Output Operator [FS_9]
            compressed:false
            Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Transform Operator [SCR_8]
               command:cat
               output info:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
               Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               Merge Join Operator [MERGEJOIN_14]
               |  condition map:[{"":"Inner Join 0 to 1"}]
               |  keys:{"1":"key (type: string)","0":"key (type: string)"}
               |  outputColumnNames:["_col0","_col1"]
               |  Statistics:Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               |<-Map 1 [SIMPLE_EDGE]
               |  Reduce Output Operator [RS_3]
               |     key expressions:key (type: string)
               |     Map-reduce partition columns:key (type: string)
               |     sort order:+
               |     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |     value expressions:value (type: string)
               |     Filter Operator [FIL_12]
               |        predicate:key is not null (type: boolean)
               |        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
               |        TableScan [TS_0]
               |           alias:a
               |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
               |<-Map 3 [SIMPLE_EDGE]
                  Reduce Output Operator [RS_5]
                     key expressions:key (type: string)
                     Map-reduce partition columns:key (type: string)
                     sort order:+
                     Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                     Filter Operator [FIL_13]
                        predicate:key is not null (type: boolean)
                        Statistics:Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                        TableScan [TS_1]
                           alias:b
                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
PREHOOK: query: explain
FROM (
      select key, value from (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2) unionsub
                         UNION all
      select key, value from src s0
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
FROM (
      select key, value from (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2) unionsub
                         UNION all
      select key, value from src s0
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 5 <- Union 3 (SIMPLE_EDGE)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Map 7 <- Union 3 (CONTAINS)
Map 6 <- Union 3 (CONTAINS)

Stage-5
   Stats-Aggr Operator
      Stage-1
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest2","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Stage-3
               Dependency Collection{}
                  Stage-2
                     Reducer 5
                     File Output Operator [FS_24]
                        compressed:false
                        Statistics:Num rows: 1 Data size: 280 Basic stats: COMPLETE Column stats: PARTIAL
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest2","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Group By Operator [GBY_22]
                        |  aggregations:["count(DISTINCT KEY._col2:0._col0)"]
                        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                        |  outputColumnNames:["_col0","_col1","_col2"]
                        |  Statistics:Num rows: 1 Data size: 280 Basic stats: COMPLETE Column stats: PARTIAL
                        |<-Union 3 [SIMPLE_EDGE]
                           |<-Reducer 2 [CONTAINS]
                           |  Reduce Output Operator [RS_15]
                           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:++
                           |     Statistics:Num rows: 500 Data size: 140000 Basic stats: COMPLETE Column stats: PARTIAL
                           |     Group By Operator [GBY_14]
                           |        aggregations:["count(DISTINCT substr(_col1, 5))"]
                           |        keys:_col0 (type: string), substr(_col1, 5) (type: string)
                           |        outputColumnNames:["_col0","_col1","_col2"]
                           |        Statistics:Num rows: 500 Data size: 140000 Basic stats: COMPLETE Column stats: PARTIAL
                           |        Select Operator [SEL_9]
                           |           outputColumnNames:["_col0","_col1"]
                           |           Statistics:Num rows: 501 Data size: 136272 Basic stats: COMPLETE Column stats: PARTIAL
                           |           Select Operator [SEL_5]
                           |              outputColumnNames:["_col0","_col1"]
                           |              Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
                           |              Group By Operator [GBY_4]
                           |              |  aggregations:["count(VALUE._col0)"]
                           |              |  outputColumnNames:["_col0"]
                           |              |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                           |              |<-Map 1 [SIMPLE_EDGE]
                           |                 Reduce Output Operator [RS_3]
                           |                    sort order:
                           |                    Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                           |                    value expressions:_col0 (type: bigint)
                           |                    Group By Operator [GBY_2]
                           |                       aggregations:["count(1)"]
                           |                       outputColumnNames:["_col0"]
                           |                       Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                           |                       Select Operator [SEL_1]
                           |                          Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                           |                          TableScan [TS_0]
                           |                             alias:s1
                           |                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                           |  Reduce Output Operator [RS_21]
                           |     key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |     sort order:+++
                           |     Statistics:Num rows: 500 Data size: 232000 Basic stats: COMPLETE Column stats: PARTIAL
                           |     Group By Operator [GBY_20]
                           |        aggregations:["count(DISTINCT substr(_col1, 5))"]
                           |        keys:_col0 (type: string), _col1 (type: string), substr(_col1, 5) (type: string)
                           |        outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |        Statistics:Num rows: 500 Data size: 232000 Basic stats: COMPLETE Column stats: PARTIAL
                           |         Please refer to the previous Select Operator [SEL_9]
                           |<-Map 7 [CONTAINS]
                           |  Reduce Output Operator [RS_15]
                           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:++
                           |     Statistics:Num rows: 500 Data size: 140000 Basic stats: COMPLETE Column stats: PARTIAL
                           |     Group By Operator [GBY_14]
                           |        aggregations:["count(DISTINCT substr(_col1, 5))"]
                           |        keys:_col0 (type: string), substr(_col1, 5) (type: string)
                           |        outputColumnNames:["_col0","_col1","_col2"]
                           |        Statistics:Num rows: 500 Data size: 140000 Basic stats: COMPLETE Column stats: PARTIAL
                           |        Select Operator [SEL_11]
                           |           outputColumnNames:["_col0","_col1"]
                           |           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |           TableScan [TS_10]
                           |              alias:s0
                           |              Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                           |  Reduce Output Operator [RS_21]
                           |     key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |     sort order:+++
                           |     Statistics:Num rows: 500 Data size: 232000 Basic stats: COMPLETE Column stats: PARTIAL
                           |     Group By Operator [GBY_20]
                           |        aggregations:["count(DISTINCT substr(_col1, 5))"]
                           |        keys:_col0 (type: string), _col1 (type: string), substr(_col1, 5) (type: string)
                           |        outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |        Statistics:Num rows: 500 Data size: 232000 Basic stats: COMPLETE Column stats: PARTIAL
                           |         Please refer to the previous Select Operator [SEL_11]
                           |<-Map 6 [CONTAINS]
                              Reduce Output Operator [RS_15]
                                 key expressions:_col0 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col0 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 500 Data size: 140000 Basic stats: COMPLETE Column stats: PARTIAL
                                 Group By Operator [GBY_14]
                                    aggregations:["count(DISTINCT substr(_col1, 5))"]
                                    keys:_col0 (type: string), substr(_col1, 5) (type: string)
                                    outputColumnNames:["_col0","_col1","_col2"]
                                    Statistics:Num rows: 500 Data size: 140000 Basic stats: COMPLETE Column stats: PARTIAL
                                    Select Operator [SEL_9]
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 501 Data size: 136272 Basic stats: COMPLETE Column stats: PARTIAL
                                       Select Operator [SEL_7]
                                          outputColumnNames:["_col0","_col1"]
                                          Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                          TableScan [TS_6]
                                             alias:s2
                                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator [RS_21]
                                 key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                 sort order:+++
                                 Statistics:Num rows: 500 Data size: 232000 Basic stats: COMPLETE Column stats: PARTIAL
                                 Group By Operator [GBY_20]
                                    aggregations:["count(DISTINCT substr(_col1, 5))"]
                                    keys:_col0 (type: string), _col1 (type: string), substr(_col1, 5) (type: string)
                                    outputColumnNames:["_col0","_col1","_col2","_col3"]
                                    Statistics:Num rows: 500 Data size: 232000 Basic stats: COMPLETE Column stats: PARTIAL
                                     Please refer to the previous Select Operator [SEL_9]
                     Reducer 4
                     File Output Operator [FS_18]
                        compressed:false
                        Statistics:Num rows: 1 Data size: 96 Basic stats: COMPLETE Column stats: PARTIAL
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Group By Operator [GBY_16]
                        |  aggregations:["count(DISTINCT KEY._col1:0._col0)"]
                        |  keys:KEY._col0 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 1 Data size: 96 Basic stats: COMPLETE Column stats: PARTIAL
                        |<- Please refer to the previous Union 3 [SIMPLE_EDGE]
Stage-4
   Stats-Aggr Operator
      Stage-0
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-3
PREHOOK: query: explain
FROM (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
PREHOOK: type: QUERY
POSTHOOK: query: explain
FROM (
      select 'tst1' as key, cast(count(1) as string) as value, 'tst1' as value2 from src s1
                         UNION all 
      select s2.key as key, s2.value as value, 'tst1' as value2 from src s2
                             ) unionsrc
INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) 
GROUP BY unionsrc.key, unionsrc.value
POSTHOOK: type: QUERY
Plan not optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
Reducer 5 <- Union 3 (SIMPLE_EDGE)
Reducer 4 <- Union 3 (SIMPLE_EDGE)
Map 6 <- Union 3 (CONTAINS)

Stage-5
   Stats-Aggr Operator
      Stage-1
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest2","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
            Stage-3
               Dependency Collection{}
                  Stage-2
                     Reducer 5
                     File Output Operator [FS_20]
                        compressed:false
                        Statistics:Num rows: 1 Data size: 280 Basic stats: COMPLETE Column stats: PARTIAL
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest2","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Group By Operator [GBY_18]
                        |  aggregations:["count(DISTINCT KEY._col2:0._col0)"]
                        |  keys:KEY._col0 (type: string), KEY._col1 (type: string)
                        |  outputColumnNames:["_col0","_col1","_col2"]
                        |  Statistics:Num rows: 1 Data size: 280 Basic stats: COMPLETE Column stats: PARTIAL
                        |<-Union 3 [SIMPLE_EDGE]
                           |<-Reducer 2 [CONTAINS]
                           |  Reduce Output Operator [RS_11]
                           |     key expressions:_col0 (type: string), _col1 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string)
                           |     sort order:++
                           |     Statistics:Num rows: 250 Data size: 70000 Basic stats: COMPLETE Column stats: PARTIAL
                           |     Group By Operator [GBY_10]
                           |        aggregations:["count(DISTINCT substr(_col1, 5))"]
                           |        keys:_col0 (type: string), substr(_col1, 5) (type: string)
                           |        outputColumnNames:["_col0","_col1","_col2"]
                           |        Statistics:Num rows: 250 Data size: 70000 Basic stats: COMPLETE Column stats: PARTIAL
                           |        Select Operator [SEL_9]
                           |           outputColumnNames:["_col0","_col1"]
                           |           Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
                           |           Select Operator [SEL_5]
                           |              outputColumnNames:["_col0","_col1"]
                           |              Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
                           |              Group By Operator [GBY_4]
                           |              |  aggregations:["count(VALUE._col0)"]
                           |              |  outputColumnNames:["_col0"]
                           |              |  Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                           |              |<-Map 1 [SIMPLE_EDGE]
                           |                 Reduce Output Operator [RS_3]
                           |                    sort order:
                           |                    Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                           |                    value expressions:_col0 (type: bigint)
                           |                    Group By Operator [GBY_2]
                           |                       aggregations:["count(1)"]
                           |                       outputColumnNames:["_col0"]
                           |                       Statistics:Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                           |                       Select Operator [SEL_1]
                           |                          Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                           |                          TableScan [TS_0]
                           |                             alias:s1
                           |                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                           |  Reduce Output Operator [RS_17]
                           |     key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                           |     Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                           |     sort order:+++
                           |     Statistics:Num rows: 250 Data size: 116000 Basic stats: COMPLETE Column stats: PARTIAL
                           |     Group By Operator [GBY_16]
                           |        aggregations:["count(DISTINCT substr(_col1, 5))"]
                           |        keys:_col0 (type: string), _col1 (type: string), substr(_col1, 5) (type: string)
                           |        outputColumnNames:["_col0","_col1","_col2","_col3"]
                           |        Statistics:Num rows: 250 Data size: 116000 Basic stats: COMPLETE Column stats: PARTIAL
                           |        Select Operator [SEL_15]
                           |           outputColumnNames:["_col0","_col1"]
                           |           Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
                           |            Please refer to the previous Select Operator [SEL_5]
                           |<-Map 6 [CONTAINS]
                              Reduce Output Operator [RS_11]
                                 key expressions:_col0 (type: string), _col1 (type: string)
                                 Map-reduce partition columns:_col0 (type: string)
                                 sort order:++
                                 Statistics:Num rows: 250 Data size: 70000 Basic stats: COMPLETE Column stats: PARTIAL
                                 Group By Operator [GBY_10]
                                    aggregations:["count(DISTINCT substr(_col1, 5))"]
                                    keys:_col0 (type: string), substr(_col1, 5) (type: string)
                                    outputColumnNames:["_col0","_col1","_col2"]
                                    Statistics:Num rows: 250 Data size: 70000 Basic stats: COMPLETE Column stats: PARTIAL
                                    Select Operator [SEL_9]
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
                                       Select Operator [SEL_7]
                                          outputColumnNames:["_col0","_col1"]
                                          Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                                          TableScan [TS_6]
                                             alias:s2
                                             Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator [RS_17]
                                 key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: string)
                                 Map-reduce partition columns:_col0 (type: string), _col1 (type: string)
                                 sort order:+++
                                 Statistics:Num rows: 250 Data size: 116000 Basic stats: COMPLETE Column stats: PARTIAL
                                 Group By Operator [GBY_16]
                                    aggregations:["count(DISTINCT substr(_col1, 5))"]
                                    keys:_col0 (type: string), _col1 (type: string), substr(_col1, 5) (type: string)
                                    outputColumnNames:["_col0","_col1","_col2","_col3"]
                                    Statistics:Num rows: 250 Data size: 116000 Basic stats: COMPLETE Column stats: PARTIAL
                                    Select Operator [SEL_15]
                                       outputColumnNames:["_col0","_col1"]
                                       Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
                                        Please refer to the previous Select Operator [SEL_7]
                     Reducer 4
                     File Output Operator [FS_14]
                        compressed:false
                        Statistics:Num rows: 1 Data size: 96 Basic stats: COMPLETE Column stats: PARTIAL
                        table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
                        Group By Operator [GBY_12]
                        |  aggregations:["count(DISTINCT KEY._col1:0._col0)"]
                        |  keys:KEY._col0 (type: string)
                        |  outputColumnNames:["_col0","_col1"]
                        |  Statistics:Num rows: 1 Data size: 96 Basic stats: COMPLETE Column stats: PARTIAL
                        |<- Please refer to the previous Union 3 [SIMPLE_EDGE]
Stage-4
   Stats-Aggr Operator
      Stage-0
         Move Operator
            table:{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","name:":"default.dest1","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}
             Please refer to the previous Stage-3
